<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.18"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>TreeNode: TreeNode.cs Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="Doxy.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="Logo.svg"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">TreeNode
   &#160;<span id="projectnumber">1.0.0</span>
   </div>
   <div id="projectbrief">A library to manipulate phylogenetic trees</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.18 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('_tree_node_8cs_source.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">TreeNode.cs</div>  </div>
</div><!--header-->
<div class="contents">
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="keyword">using</span> System;</div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="keyword">using</span> System.Collections.Generic;</div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="keyword">using</span> System.Diagnostics.Contracts;</div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="keyword">using</span> System.Linq;</div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="keyword">using</span> <a class="code" href="namespace_phylo_tree.html">PhyloTree</a>.<a class="code" href="namespace_phylo_tree_1_1_extensions.html">Extensions</a>;</div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="keyword">using</span> <a class="code" href="namespace_phylo_tree.html">PhyloTree</a>.<a class="code" href="namespace_phylo_tree_1_1_formats.html">Formats</a>;</div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="keyword">using</span> System.Diagnostics.CodeAnalysis;</div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="keyword">using</span> System.Security;</div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160; </div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;[assembly: SuppressMessage(<span class="stringliteral">&quot;Globalization&quot;</span>, <span class="stringliteral">&quot;CA1303&quot;</span>)]</div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment">/// &lt;summary&gt;</span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment">/// Contains classes and methods to read, write and manipulate phylogenetic trees.</span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment">/// &lt;/summary&gt;</span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment"></span><span class="keyword">namespace </span><a class="code" href="namespace_phylo_tree.html">PhyloTree</a></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;{<span class="comment"></span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="comment">    /// &lt;summary&gt;</span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="comment">    /// Represents a split induced by a branch in a tree.</span></div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="comment">    /// &lt;/summary&gt;</span></div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="comment"></span>    <span class="keyword">internal</span> <span class="keyword">class </span>Split</div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;    {<span class="comment"></span></div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="comment">        /// &lt;summary&gt;</span></div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="comment">        /// The name of the split. It consists of a series of comma-separated tip names, optionally followed by a vertical bar | and by another series of comma-separated tip names.</span></div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="comment">        /// E.g. &quot;A,B|C,D&quot;</span></div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="comment">        /// &lt;/summary&gt;</span></div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="comment"></span>        <span class="keyword">public</span> <span class="keywordtype">string</span> Name { <span class="keyword">get</span>; }</div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="comment">        /// &lt;summary&gt;</span></div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="comment">        /// The length of the split (representing either the age of the node that induced it or the length of the branch).</span></div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="comment">        /// &lt;/summary&gt;</span></div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="comment"></span>        <span class="keyword">public</span> <span class="keywordtype">double</span> Length { <span class="keyword">get</span>; }</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="comment">        /// &lt;summary&gt;</span></div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="comment">        /// The support value for the split.</span></div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="comment">        /// &lt;/summary&gt;</span></div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="comment"></span>        <span class="keyword">public</span> <span class="keywordtype">double</span> Support { <span class="keyword">get</span>; }</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="comment">        /// &lt;summary&gt;</span></div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="comment">        /// Determines whether the &lt;see cref=&quot;Length&quot;/&gt; property contains the age of the node that induced the split or the length of the branch.</span></div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<span class="comment">        /// &lt;/summary&gt;</span></div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="comment"></span>        <span class="keyword">public</span> LengthTypes LengthType { <span class="keyword">get</span>; }</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160; </div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;<span class="comment">        /// &lt;summary&gt;</span></div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;<span class="comment">        /// Determines whether the &lt;see cref=&quot;Length&quot;/&gt; of the split contains the age of the node that induced the split or the length of the branch.</span></div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;<span class="comment">        /// &lt;/summary&gt;</span></div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;<span class="comment"></span>        <span class="keyword">public</span> <span class="keyword">enum</span> LengthTypes</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;        {<span class="comment"></span></div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;<span class="comment">            /// &lt;summary&gt;</span></div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;<span class="comment">            /// The &lt;see cref=&quot;Split.Length&quot;/&gt; of the split contains the length of the branch that induced it.</span></div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;<span class="comment">            /// &lt;/summary&gt;</span></div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;<span class="comment"></span>            Length,<span class="comment"></span></div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;<span class="comment">            /// &lt;summary&gt;</span></div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;<span class="comment">            /// The &lt;see cref=&quot;Split.Length&quot;/&gt; of the split contains the age of the node that induced it.</span></div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;<span class="comment">            /// &lt;/summary&gt;</span></div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;<span class="comment"></span>            Age</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;        }</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;<span class="comment">        /// &lt;summary&gt;</span></div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;<span class="comment">        /// Creates a &lt;see cref=&quot;Split&quot;/&gt; object.</span></div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;<span class="comment">        /// &lt;/summary&gt;</span></div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;<span class="comment">        /// &lt;param name=&quot;name&quot;&gt;The name of the split.&lt;/param&gt;</span></div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;<span class="comment">        /// &lt;param name=&quot;length&quot;&gt;The length of the split.&lt;/param&gt;</span></div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;<span class="comment">        /// &lt;param name=&quot;lengthType&quot;&gt;Determines whether &lt;paramref name=&quot;length&quot;/&gt; contains the age of the node that induced the split or the length of the branch.&lt;/param&gt;</span></div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;<span class="comment">        /// &lt;param name=&quot;support&quot;&gt;The support value of the split.&lt;/param&gt;</span></div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;<span class="comment"></span>        <span class="keyword">public</span> Split(<span class="keywordtype">string</span> name, <span class="keywordtype">double</span> length, LengthTypes lengthType, <span class="keywordtype">double</span> support)</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;        {</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;            this.Name = name;</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;            this.Length = length;</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;            this.Support = support;</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;            this.LengthType = lengthType;</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;        }</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;<span class="comment">        /// &lt;summary&gt;</span></div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;<span class="comment">        /// Determines whether two &lt;see cref=&quot;Split&quot;/&gt;s are compatible with each other.</span></div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;<span class="comment">        /// &lt;/summary&gt;</span></div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;<span class="comment">        /// &lt;param name=&quot;s1&quot;&gt;The first &lt;see cref=&quot;Split&quot;/&gt; to compare.&lt;/param&gt;</span></div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;<span class="comment">        /// &lt;param name=&quot;s2&quot;&gt;The second &lt;see cref=&quot;Split&quot;/&gt; to compare.&lt;/param&gt;</span></div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;<span class="comment">        /// &lt;returns&gt;&lt;c&gt;true&lt;/c&gt; if the two &lt;see cref=&quot;Split&quot;/&gt;s are compatible with each other, &lt;c&gt;false&lt;/c&gt; if the are not.&lt;/returns&gt;</span></div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;<span class="comment"></span>        <span class="keyword">public</span> <span class="keyword">static</span> <span class="keywordtype">bool</span> AreCompatible(Split s1, Split s2)</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;        {</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;            <span class="keywordflow">if</span> (!s1.Name.Contains(<span class="stringliteral">&quot;|&quot;</span>, StringComparison.OrdinalIgnoreCase) &amp;&amp; !s2.Name.Contains(<span class="stringliteral">&quot;|&quot;</span>, StringComparison.OrdinalIgnoreCase))</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;            {</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;                <span class="keywordtype">string</span>[] leaves1 = s1.Name.Split(<span class="charliteral">&#39;,&#39;</span>);</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;                <span class="keywordtype">string</span>[] leaves2 = s2.Name.Split(<span class="charliteral">&#39;,&#39;</span>);</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160; </div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;                <span class="keywordflow">return</span> !leaves1.ContainsAny(leaves2) || leaves1.ContainsAll(leaves2) || leaves2.ContainsAll(leaves1);</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;            }</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;            {</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;                <span class="keywordtype">string</span>[][] leaves1 = (from el in s1.Name.Split(<span class="charliteral">&#39;|&#39;</span>) select el.Split(<span class="charliteral">&#39;,&#39;</span>)).ToArray();</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;                <span class="keywordtype">string</span>[][] leaves2 = (from el in s2.Name.Split(<span class="charliteral">&#39;|&#39;</span>) select el.Split(<span class="charliteral">&#39;,&#39;</span>)).ToArray();</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160; </div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;                <span class="keywordflow">if</span> (leaves1.Length == 2 &amp;&amp; leaves2.Length == 2)</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;                {</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;                    <span class="keywordflow">return</span> !leaves1[0].Intersect(leaves2[0]).Any() || !leaves1[0].Intersect(leaves2[1]).Any() || !leaves1[1].Intersect(leaves2[0]).Any() || !leaves1[1].Intersect(leaves2[1]).Any();</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;                }</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;                <span class="keywordflow">else</span> <span class="keywordflow">if</span> (leaves1.Length == 1 &amp;&amp; leaves2.Length == 2)</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;                {</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;                    <span class="keywordflow">return</span> (!leaves1[0].ContainsAny(leaves2[0]) || leaves1[0].ContainsAll(leaves2[0]) || leaves2[0].ContainsAll(leaves1[0])) &amp;&amp; (!leaves1[0].ContainsAny(leaves2[1]) || leaves1[0].ContainsAll(leaves2[1]) || leaves2[1].ContainsAll(leaves1[0]));</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;                }</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;                <span class="keywordflow">else</span> <span class="keywordflow">if</span> (leaves1.Length == 2 &amp;&amp; leaves2.Length == 1)</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;                {</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;                    <span class="keywordflow">return</span> (!leaves2[0].ContainsAny(leaves1[0]) || leaves2[0].ContainsAll(leaves1[0]) || leaves1[0].ContainsAll(leaves2[0])) &amp;&amp; (!leaves2[0].ContainsAny(leaves1[1]) || leaves2[0].ContainsAll(leaves1[1]) || leaves1[1].ContainsAll(leaves2[0]));</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;                }</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;                <span class="keywordflow">else</span></div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;                {</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;                    <span class="keywordflow">throw</span> <span class="keyword">new</span> NotImplementedException();</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;                }</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;            }</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;        }</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;<span class="comment">        /// &lt;summary&gt;</span></div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;<span class="comment">        /// Gets the children on the left of the split.</span></div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;<span class="comment">        /// &lt;/summary&gt;</span></div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;<span class="comment">        /// &lt;returns&gt;The children on the left of the split.&lt;/returns&gt;</span></div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;<span class="comment"></span>        <span class="keyword">public</span> IEnumerable&lt;string&gt; GetChildrenLeft()</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;        {</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;            <span class="keywordflow">if</span> (this.Name.Contains(<span class="charliteral">&#39;|&#39;</span>, StringComparison.OrdinalIgnoreCase))</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;            {</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;                <span class="keywordflow">return</span> this.Name.Split(<span class="charliteral">&#39;|&#39;</span>)[0].Split(<span class="charliteral">&#39;,&#39;</span>);</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;            }</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;            {</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;                <span class="keywordflow">return</span> this.Name.Split(<span class="charliteral">&#39;,&#39;</span>);</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;            }</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;        }</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;<span class="comment">        /// &lt;summary&gt;</span></div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;<span class="comment">        /// Gets the children on the right of the split.</span></div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;<span class="comment">        /// &lt;/summary&gt;</span></div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;<span class="comment">        /// &lt;returns&gt;The children on the right of the split.&lt;/returns&gt;</span></div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;<span class="comment"></span>        <span class="keyword">public</span> IEnumerable&lt;string&gt; GetChildrenRight()</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;        {</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;            <span class="keywordflow">if</span> (this.Name.Contains(<span class="charliteral">&#39;|&#39;</span>, StringComparison.OrdinalIgnoreCase))</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;            {</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;                <span class="keywordflow">return</span> this.Name.Split(<span class="charliteral">&#39;|&#39;</span>)[1].Split(<span class="charliteral">&#39;,&#39;</span>);</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;            }</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;            {</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;                <span class="keywordflow">return</span> this.Name.Split(<span class="charliteral">&#39;,&#39;</span>);</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;            }</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;        }</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;<span class="comment">        /// &lt;summary&gt;</span></div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;<span class="comment">        /// Determines whether multiple &lt;see cref=&quot;Split&quot;/&gt;s are compatible with each other.</span></div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;<span class="comment">        /// &lt;/summary&gt;</span></div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;<span class="comment">        /// &lt;param name=&quot;splits&quot;&gt;The &lt;see cref=&quot;Split&quot;/&gt;s to compare.&lt;/param&gt;</span></div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;<span class="comment">        /// &lt;returns&gt;&lt;c&gt;true&lt;/c&gt; if all the &lt;see cref=&quot;Split&quot;/&gt;s are compatible with each other, &lt;c&gt;false&lt;/c&gt; if the are not.&lt;/returns&gt;</span></div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;<span class="comment"></span>        <span class="keyword">public</span> <span class="keywordtype">bool</span> IsCompatible(IEnumerable&lt;Split&gt; splits)</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;        {</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;            <span class="keywordflow">foreach</span> (Split split <span class="keywordflow">in</span> splits)</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;            {</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;                <span class="keywordflow">if</span> (!AreCompatible(split, <span class="keyword">this</span>))</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;                {</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;                    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;                }</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;            }</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;        }</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160; </div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;<span class="comment">        /// &lt;summary&gt;</span></div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;<span class="comment">        /// Builds a rooted or unrooted tree starting from a collection of compatible &lt;see cref=&quot;Split&quot;/&gt;s.</span></div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;<span class="comment">        /// &lt;/summary&gt;</span></div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;<span class="comment">        /// &lt;param name=&quot;splits&quot;&gt;The &lt;see cref=&quot;Split&quot;/&gt;s to use in building the tree. This method assumes that they are all compatible with each other.&lt;/param&gt;</span></div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;<span class="comment">        /// &lt;param name=&quot;rooted&quot;&gt;Whether to build a rooted or an unrooted tree.&lt;/param&gt;</span></div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;<span class="comment">        /// &lt;returns&gt;A &lt;see cref=&quot;TreeNode&quot;/&gt; containing the tree represented by the &lt;see cref=&quot;Split&quot;/&gt;s.&lt;/returns&gt;</span></div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;<span class="comment"></span>        <span class="keyword">public</span> <span class="keyword">static</span> TreeNode BuildTree(IEnumerable&lt;Split&gt; splits, <span class="keywordtype">bool</span> rooted)</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;        {</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;            List&lt;TreeNode&gt; nodes = <span class="keyword">new</span> List&lt;TreeNode&gt;();</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160; </div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;            List&lt;Split&gt; allSplits = splits.ToList();</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160; </div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;            HashSet&lt;string&gt; addedTips = <span class="keyword">new</span> HashSet&lt;string&gt;();</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160; </div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;            <span class="keywordtype">string</span>[][] splitChildrenLeft = <span class="keyword">new</span> <span class="keywordtype">string</span>[allSplits.Count][];</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;            <span class="keywordtype">string</span>[][] splitChildrenRight = <span class="keyword">new</span> <span class="keywordtype">string</span>[allSplits.Count][];</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160; </div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;            <span class="keywordtype">bool</span> clockLike = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160; </div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; allSplits.Count; i++)</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;            {</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;                <span class="keywordflow">if</span> (allSplits[i].LengthType != Split.LengthTypes.Age)</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;                {</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;                    clockLike = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;                }</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160; </div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;                splitChildrenLeft[i] = allSplits[i].GetChildrenLeft().ToArray();</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;                splitChildrenRight[i] = allSplits[i].GetChildrenRight().ToArray();</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;                <span class="keywordflow">if</span> (splitChildrenLeft[i].Length == 1)</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;                {</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;                    <span class="keywordflow">if</span> (addedTips.Add(splitChildrenLeft[i][0]))</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;                    {</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;                        TreeNode child = <span class="keyword">new</span> TreeNode(<span class="keyword">null</span>) { Name = splitChildrenLeft[i][0], Support = allSplits[i].Support, Length = allSplits[i].Length };</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;                        nodes.Add(child);</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;                    }</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;                }</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;                <span class="keywordflow">if</span> (splitChildrenRight[i].Length == 1)</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;                {</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;                    <span class="keywordflow">if</span> (addedTips.Add(splitChildrenRight[i][0]))</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;                    {</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;                        TreeNode child = <span class="keyword">new</span> TreeNode(<span class="keyword">null</span>) { Name = splitChildrenRight[i][0], Support = allSplits[i].Support, Length = allSplits[i].Length };</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;                        nodes.Add(child);</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;                    }</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;                }</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160; </div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;                <span class="keywordflow">if</span> (!rooted &amp;&amp; splitChildrenLeft[i].Length &gt; splitChildrenRight[i].Length)</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;                {</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;                    <span class="keywordtype">string</span>[] temp = splitChildrenLeft[i];</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;                    splitChildrenLeft[i] = splitChildrenRight[i];</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;                    splitChildrenRight[i] = temp;</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;                }</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;            }</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160; </div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;            <span class="keywordtype">int</span> maxCoalescence = nodes.Count;</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;            </div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 2; i &lt;= maxCoalescence; i++)</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;            {</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;                Coalesce(splitChildrenLeft, nodes, allSplits, i);</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;            }</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160; </div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160; </div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;            <span class="keywordflow">if</span> (clockLike)</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;            {</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;                nodes = nodes[0].GetChildrenRecursive();</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160; </div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = nodes.Count - 1; i &gt;= 0; i--)</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;                {</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;                    <span class="keywordflow">if</span> (nodes[i].Parent != <span class="keyword">null</span>)</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;                    {</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;                        nodes[i].Length = nodes[i].Parent.Length - nodes[i].Length;</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;                    }</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;                    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;                    {</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;                        nodes[i].Length = <span class="keywordtype">double</span>.NaN;</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;                    }</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;                }</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;            }</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160; </div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;            <span class="keywordflow">if</span> (nodes[0].Children.Count &lt; 3 &amp;&amp; !rooted)</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;            {</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;                nodes[0] = nodes[0].GetUnrootedTree();</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;            }</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160; </div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;            <span class="keywordflow">return</span> nodes[0];</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;        }</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;<span class="comment">        /// &lt;summary&gt;</span></div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;<span class="comment">        /// Coalesces nodes as commanded by the supplies list of &lt;see cref=&quot;Split&quot;/&gt;s.</span></div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;<span class="comment">        /// &lt;/summary&gt;</span></div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;<span class="comment">        /// &lt;param name=&quot;splitChildrenLeft&quot;&gt;The tips specified on the left side of each split.&lt;/param&gt;</span></div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;<span class="comment">        /// &lt;param name=&quot;nodes&quot;&gt;The list of &lt;see cref=&quot;TreeNode&quot;/&gt;s that will be coalesced.&lt;/param&gt;</span></div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;<span class="comment">        /// &lt;param name=&quot;allSplits&quot;&gt;The list of &lt;see cref=&quot;Split&quot;/&gt;s describing the tree.&lt;/param&gt;</span></div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;<span class="comment">        /// &lt;param name=&quot;level&quot;&gt;The level at which to coalesce. This method should be invoked multiple times, with &lt;paramref name=&quot;level&quot;/&gt; increasing from 2 up to the number of tips in the tree (inclusive).&lt;/param&gt;</span></div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;<span class="comment"></span>        <span class="keyword">private</span> <span class="keyword">static</span> <span class="keywordtype">void</span> Coalesce(<span class="keywordtype">string</span>[][] splitChildrenLeft, List&lt;TreeNode&gt; nodes, List&lt;Split&gt; allSplits, <span class="keywordtype">int</span> level)</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;        {</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; allSplits.Count; i++)</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;            {</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;                <span class="keywordflow">if</span> (splitChildrenLeft[i].Length == level)</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;                {</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;                    List&lt;TreeNode&gt; currChildren = <span class="keyword">new</span> List&lt;TreeNode&gt;();</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;                    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; nodes.Count; j++)</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;                    {</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;                        <span class="keywordflow">if</span> (splitChildrenLeft[i].ContainsAll(nodes[j].GetLeafNames()))</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;                        {</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;                            currChildren.Add(nodes[j]);</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;                        }</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;                    }</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;                    <span class="keywordflow">if</span> (currChildren.Count &gt; 1)</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;                    {</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;                        TreeNode parent = <span class="keyword">new</span> TreeNode(<span class="keyword">null</span>) { Support = allSplits[i].Support, Length = allSplits[i].Length };</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;                        parent.Children.AddRange(currChildren);</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160; </div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;                        <span class="keywordflow">foreach</span> (TreeNode node <span class="keywordflow">in</span> currChildren)</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;                        {</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;                            nodes.Remove(node);</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;                            node.Parent = parent;</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;                        }</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160; </div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;                        nodes.Add(parent);</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;                    }</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;                    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;                    {</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;                        currChildren[0].Support = Math.Min(currChildren[0].Support, allSplits[i].Support);</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160; </div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;                        <span class="keywordflow">if</span> (allSplits[i].LengthType == LengthTypes.Length)</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;                        {</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;                            currChildren[0].Length = currChildren[0].Length + allSplits[i].Length;</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;                        }</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;                        <span class="keywordflow">else</span></div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;                        {</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;                            currChildren[0].Length = allSplits[i].Length;</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;                        }</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;                    }</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;                }</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;            }</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;        }</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;    }</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;<span class="comment">    /// &lt;summary&gt;</span></div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;<span class="comment">    /// Represents a node in a tree (or a whole tree).</span></div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;<span class="comment">    /// &lt;/summary&gt;</span></div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;<span class="comment"></span>    [Serializable]</div>
<div class="line"><a name="l00305"></a><span class="lineno"><a class="line" href="class_phylo_tree_1_1_tree_node.html">  305</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">class </span><a class="code" href="class_phylo_tree_1_1_tree_node.html">TreeNode</a></div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;    {<span class="comment"></span></div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;<span class="comment">        /// &lt;summary&gt;</span></div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;<span class="comment">        /// The parent node of this node. This will be &lt;c&gt;null&lt;/c&gt; for the root node.</span></div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;<span class="comment">        /// &lt;/summary&gt;</span></div>
<div class="line"><a name="l00310"></a><span class="lineno"><a class="line" href="class_phylo_tree_1_1_tree_node.html#ad013d0a85374f6055b067d21ec455aa8">  310</a></span>&#160;<span class="comment"></span>        <span class="keyword">public</span> <a class="code" href="class_phylo_tree_1_1_tree_node.html">TreeNode</a> <a class="code" href="class_phylo_tree_1_1_tree_node.html#ad013d0a85374f6055b067d21ec455aa8">Parent</a> { <span class="keyword">get</span>; <span class="keyword">set</span>; }</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;<span class="comment">        /// &lt;summary&gt;</span></div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;<span class="comment">        /// The child nodes of this node. This will be empty (but initialised) for leaf nodes.</span></div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;<span class="comment">        /// &lt;/summary&gt;</span></div>
<div class="line"><a name="l00315"></a><span class="lineno"><a class="line" href="class_phylo_tree_1_1_tree_node.html#a0ea3341e47207ba0fc9d2262eef7f681">  315</a></span>&#160;<span class="comment"></span>        <span class="keyword">public</span> List&lt;TreeNode&gt; <a class="code" href="class_phylo_tree_1_1_tree_node.html#a0ea3341e47207ba0fc9d2262eef7f681">Children</a> { <span class="keyword">get</span>; }</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;<span class="comment">        /// &lt;summary&gt;</span></div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;<span class="comment">        /// The attributes of this node. Attributes &lt;see cref=&quot;Name&quot;/&gt;, &lt;see cref=&quot;Length&quot;/&gt; and &lt;see cref=&quot;Support&quot;/&gt; are always included. See the respective properties for default values.</span></div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;<span class="comment">        /// &lt;/summary&gt;</span></div>
<div class="line"><a name="l00320"></a><span class="lineno"><a class="line" href="class_phylo_tree_1_1_tree_node.html#a27ac3f4d53bdbc14e0b45ada083407ec">  320</a></span>&#160;<span class="comment"></span>        <span class="keyword">public</span> <a class="code" href="class_phylo_tree_1_1_attribute_dictionary.html">AttributeDictionary</a> <a class="code" href="class_phylo_tree_1_1_tree_node.html#a27ac3f4d53bdbc14e0b45ada083407ec">Attributes</a> { <span class="keyword">get</span>; } = <span class="keyword">new</span> <a class="code" href="class_phylo_tree_1_1_attribute_dictionary.html">AttributeDictionary</a>();</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;<span class="comment">        /// &lt;summary&gt;</span></div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;<span class="comment">        /// The length of the branch leading to this node. This is &lt;c&gt;double.NaN&lt;/c&gt; for branches whose length is not specified (e.g. the root node).</span></div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;<span class="comment">        /// &lt;/summary&gt;</span></div>
<div class="line"><a name="l00325"></a><span class="lineno"><a class="line" href="class_phylo_tree_1_1_tree_node.html#a86b94683f7e5ba653601ad8068945e69">  325</a></span>&#160;<span class="comment"></span>        <span class="keyword">public</span> <span class="keywordtype">double</span> <a class="code" href="class_phylo_tree_1_1_tree_node.html#a86b94683f7e5ba653601ad8068945e69">Length</a></div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;        {</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;            <span class="keyword">get</span></div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;            {</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;                <span class="keywordflow">return</span> <a class="code" href="class_phylo_tree_1_1_tree_node.html#a27ac3f4d53bdbc14e0b45ada083407ec">Attributes</a>.<a class="code" href="class_phylo_tree_1_1_attribute_dictionary.html#ac16319eeef4510cf5c8fde78d0f12fcc">Length</a>;</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;            }</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;            <span class="keyword">set</span></div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;            {</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;                <a class="code" href="class_phylo_tree_1_1_tree_node.html#a27ac3f4d53bdbc14e0b45ada083407ec">Attributes</a>.<a class="code" href="class_phylo_tree_1_1_attribute_dictionary.html#ac16319eeef4510cf5c8fde78d0f12fcc">Length</a> = value;</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;            }</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;        }</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;<span class="comment">        /// &lt;summary&gt;</span></div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;<span class="comment">        /// The support value of this node. This is &lt;c&gt;double.NaN&lt;/c&gt; for branches whose support is not specified. The interpretation of the support value depends on how the tree was built.</span></div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;<span class="comment">        /// &lt;/summary&gt;</span></div>
<div class="line"><a name="l00340"></a><span class="lineno"><a class="line" href="class_phylo_tree_1_1_tree_node.html#a3ab120b9c1bc00902321bb42fcd81225">  340</a></span>&#160;<span class="comment"></span>        <span class="keyword">public</span> <span class="keywordtype">double</span> <a class="code" href="class_phylo_tree_1_1_tree_node.html#a3ab120b9c1bc00902321bb42fcd81225">Support</a></div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;        {</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;            <span class="keyword">get</span></div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;            {</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;                <span class="keywordflow">return</span> <a class="code" href="class_phylo_tree_1_1_tree_node.html#a27ac3f4d53bdbc14e0b45ada083407ec">Attributes</a>.<a class="code" href="class_phylo_tree_1_1_attribute_dictionary.html#ab8b78a3ae44036451b3c42d9f42ef320">Support</a>;</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;            }</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;            <span class="keyword">set</span></div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;            {</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;                <a class="code" href="class_phylo_tree_1_1_tree_node.html#a27ac3f4d53bdbc14e0b45ada083407ec">Attributes</a>.<a class="code" href="class_phylo_tree_1_1_attribute_dictionary.html#ab8b78a3ae44036451b3c42d9f42ef320">Support</a> = value;</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;            }</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;        }</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;<span class="comment">        /// &lt;summary&gt;</span></div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;<span class="comment">        /// The name of this node (e.g. the species name for leaf nodes). Default is &lt;c&gt;&quot;&quot;&lt;/c&gt;.</span></div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;<span class="comment">        /// &lt;/summary&gt;</span></div>
<div class="line"><a name="l00355"></a><span class="lineno"><a class="line" href="class_phylo_tree_1_1_tree_node.html#a4884c49733bb5cf44f6d3f7fd796250e">  355</a></span>&#160;<span class="comment"></span>        <span class="keyword">public</span> <span class="keywordtype">string</span> <a class="code" href="class_phylo_tree_1_1_tree_node.html#a4884c49733bb5cf44f6d3f7fd796250e">Name</a></div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;        {</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;            <span class="keyword">get</span></div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;            {</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;                <span class="keywordflow">return</span> <a class="code" href="class_phylo_tree_1_1_tree_node.html#a27ac3f4d53bdbc14e0b45ada083407ec">Attributes</a>.<a class="code" href="class_phylo_tree_1_1_attribute_dictionary.html#a018e1cb442e42860a608ae4182282146">Name</a>;</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;            }</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;            <span class="keyword">set</span></div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;            {</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;                <a class="code" href="class_phylo_tree_1_1_tree_node.html#a27ac3f4d53bdbc14e0b45ada083407ec">Attributes</a>.<a class="code" href="class_phylo_tree_1_1_attribute_dictionary.html#a018e1cb442e42860a608ae4182282146">Name</a> = value;</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;            }</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;        }</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160; </div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;<span class="comment">        /// &lt;summary&gt;</span></div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;<span class="comment">        /// A univocal identifier for the node.</span></div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;<span class="comment">        /// &lt;/summary&gt;</span></div>
<div class="line"><a name="l00371"></a><span class="lineno"><a class="line" href="class_phylo_tree_1_1_tree_node.html#a4ef1e16b6ce765e8c54ff1ec32fb68a0">  371</a></span>&#160;<span class="comment"></span>        <span class="keyword">public</span> <span class="keywordtype">string</span> <a class="code" href="class_phylo_tree_1_1_tree_node.html#a4ef1e16b6ce765e8c54ff1ec32fb68a0">Id</a> { <span class="keyword">get</span>; <span class="keyword">private</span> <span class="keyword">set</span>; }</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;<span class="comment">        /// &lt;summary&gt;</span></div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;<span class="comment">        /// Creates a new &lt;see cref=&quot;TreeNode&quot;/&gt; object.</span></div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;<span class="comment">        /// &lt;/summary&gt;</span></div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;<span class="comment">        /// &lt;param name=&quot;parent&quot;&gt;The parent node of this node. For the root node, this should be &lt;c&gt;null&lt;/c&gt;.&lt;/param&gt;</span></div>
<div class="line"><a name="l00377"></a><span class="lineno"><a class="line" href="class_phylo_tree_1_1_tree_node.html#af46398d315eaa6c973f21655baed8030">  377</a></span>&#160;<span class="comment"></span>        <span class="keyword">public</span> <a class="code" href="class_phylo_tree_1_1_tree_node.html#af46398d315eaa6c973f21655baed8030">TreeNode</a>(<a class="code" href="class_phylo_tree_1_1_tree_node.html">TreeNode</a> parent)</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;        {</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;            <a class="code" href="class_phylo_tree_1_1_tree_node.html#ad013d0a85374f6055b067d21ec455aa8">Parent</a> = parent;</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;            <a class="code" href="class_phylo_tree_1_1_tree_node.html#a4ef1e16b6ce765e8c54ff1ec32fb68a0">Id</a> = Guid.NewGuid().ToString();</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;            <a class="code" href="class_phylo_tree_1_1_tree_node.html#a0ea3341e47207ba0fc9d2262eef7f681">Children</a> = <span class="keyword">new</span> List&lt;TreeNode&gt;();</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;        }</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;<span class="comment">        /// &lt;summary&gt;</span></div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;<span class="comment">        /// Checks whether the node belongs to a rooted tree.</span></div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;<span class="comment">        /// &lt;/summary&gt;</span></div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;<span class="comment">        /// &lt;returns&gt;&lt;c&gt;true&lt;/c&gt; if the node belongs to a rooted tree, &lt;c&gt;false&lt;/c&gt; otherwise.&lt;/returns&gt;</span></div>
<div class="line"><a name="l00388"></a><span class="lineno"><a class="line" href="class_phylo_tree_1_1_tree_node.html#af0e513c07c0f93a13eff4f88573b2af5">  388</a></span>&#160;<span class="comment"></span>        <span class="keyword">public</span> <span class="keywordtype">bool</span> <a class="code" href="class_phylo_tree_1_1_tree_node.html#af0e513c07c0f93a13eff4f88573b2af5">IsRooted</a>()</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;        {</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;            <span class="keywordflow">return</span> this.<a class="code" href="class_phylo_tree_1_1_tree_node.html#af08b6ddc4fdf955f91e53a6ca7554538">GetRootNode</a>().<a class="code" href="class_phylo_tree_1_1_tree_node.html#a0ea3341e47207ba0fc9d2262eef7f681">Children</a>.Count &lt; 3;</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;        }</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;<span class="comment">        /// &lt;summary&gt;</span></div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;<span class="comment">        /// Get an unrooted version of the tree.</span></div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;<span class="comment">        /// &lt;/summary&gt;</span></div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;<span class="comment">        /// &lt;returns&gt;A &lt;see cref=&quot;TreeNode&quot;/&gt; containing the unrooted tree, having at least 3 children.&lt;/returns&gt;</span></div>
<div class="line"><a name="l00397"></a><span class="lineno"><a class="line" href="class_phylo_tree_1_1_tree_node.html#a17dbe72e48873a91dea484509fd636f6">  397</a></span>&#160;<span class="comment"></span>        <span class="keyword">public</span> <a class="code" href="class_phylo_tree_1_1_tree_node.html">TreeNode</a> <a class="code" href="class_phylo_tree_1_1_tree_node.html#a17dbe72e48873a91dea484509fd636f6">GetUnrootedTree</a>()</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;        {</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;            <span class="comment">//A tree is unrooted if the root node has at least 3 children</span></div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;            <span class="keywordflow">if</span> (this.<a class="code" href="class_phylo_tree_1_1_tree_node.html#a0ea3341e47207ba0fc9d2262eef7f681">Children</a>.Count &gt;= 3)</div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;            {</div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;                <span class="comment">//If the tree is already unrooted, just return a clone</span></div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;                <span class="keywordflow">return</span> this.<a class="code" href="class_phylo_tree_1_1_tree_node.html#aa0016b82b80aded16c7c91a172d0c7a6">Clone</a>();</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;            }</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;            {</div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;                <span class="comment">//At this point, assume that the root node has 2 children</span></div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160; </div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;                <span class="comment">//If the second child of the root node is not a leaf node (i.e. it has 2 children), we can take the first child of the root node and graft it onto the second child; the second child will now have 3 children and will be the root node of the unrooted tree</span></div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;                <span class="keywordflow">if</span> (this.<a class="code" href="class_phylo_tree_1_1_tree_node.html#a0ea3341e47207ba0fc9d2262eef7f681">Children</a>[1].<a class="code" href="class_phylo_tree_1_1_tree_node.html#a0ea3341e47207ba0fc9d2262eef7f681">Children</a>.Count == 2)</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;                {</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;                    <a class="code" href="class_phylo_tree_1_1_tree_node.html">TreeNode</a> child1 = this.<a class="code" href="class_phylo_tree_1_1_tree_node.html#a0ea3341e47207ba0fc9d2262eef7f681">Children</a>[1].Clone();</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;                    <a class="code" href="class_phylo_tree_1_1_tree_node.html">TreeNode</a> child0 = this.<a class="code" href="class_phylo_tree_1_1_tree_node.html#a0ea3341e47207ba0fc9d2262eef7f681">Children</a>[0].Clone();</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;                    child0.<a class="code" href="class_phylo_tree_1_1_tree_node.html#ad013d0a85374f6055b067d21ec455aa8">Parent</a> = child1;</div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;                    child0.<a class="code" href="class_phylo_tree_1_1_tree_node.html#a86b94683f7e5ba653601ad8068945e69">Length</a> += child1.<a class="code" href="class_phylo_tree_1_1_tree_node.html#a86b94683f7e5ba653601ad8068945e69">Length</a>;</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;                    child1.<a class="code" href="class_phylo_tree_1_1_tree_node.html#a0ea3341e47207ba0fc9d2262eef7f681">Children</a>.Add(child0);</div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;                    child1.<a class="code" href="class_phylo_tree_1_1_tree_node.html#ad013d0a85374f6055b067d21ec455aa8">Parent</a> = <span class="keyword">null</span>;</div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;                    child1.<a class="code" href="class_phylo_tree_1_1_tree_node.html#a86b94683f7e5ba653601ad8068945e69">Length</a> = <span class="keywordtype">double</span>.NaN;</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;                    child1.<a class="code" href="class_phylo_tree_1_1_tree_node.html#a4884c49733bb5cf44f6d3f7fd796250e">Name</a> = this.<a class="code" href="class_phylo_tree_1_1_tree_node.html#a4884c49733bb5cf44f6d3f7fd796250e">Name</a>;</div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;                    <span class="keywordflow">return</span> child1;</div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;                }</div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;                <span class="keywordflow">else</span></div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;                {</div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;                    <span class="comment">//If the second child of the root node is a leaf node, then the first child must not be a leaf node; thus we do the same as before, but swapping the two children </span></div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;                    <a class="code" href="class_phylo_tree_1_1_tree_node.html">TreeNode</a> child0 = this.<a class="code" href="class_phylo_tree_1_1_tree_node.html#a0ea3341e47207ba0fc9d2262eef7f681">Children</a>[1].Clone();</div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;                    <a class="code" href="class_phylo_tree_1_1_tree_node.html">TreeNode</a> child1 = this.<a class="code" href="class_phylo_tree_1_1_tree_node.html#a0ea3341e47207ba0fc9d2262eef7f681">Children</a>[0].Clone();</div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;                    child0.<a class="code" href="class_phylo_tree_1_1_tree_node.html#ad013d0a85374f6055b067d21ec455aa8">Parent</a> = child1;</div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;                    child0.<a class="code" href="class_phylo_tree_1_1_tree_node.html#a86b94683f7e5ba653601ad8068945e69">Length</a> += child1.<a class="code" href="class_phylo_tree_1_1_tree_node.html#a86b94683f7e5ba653601ad8068945e69">Length</a>;</div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;                    child1.<a class="code" href="class_phylo_tree_1_1_tree_node.html#a0ea3341e47207ba0fc9d2262eef7f681">Children</a>.Add(child0);</div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;                    child1.<a class="code" href="class_phylo_tree_1_1_tree_node.html#ad013d0a85374f6055b067d21ec455aa8">Parent</a> = <span class="keyword">null</span>;</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;                    child1.<a class="code" href="class_phylo_tree_1_1_tree_node.html#a86b94683f7e5ba653601ad8068945e69">Length</a> = <span class="keywordtype">double</span>.NaN;</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;                    child1.<a class="code" href="class_phylo_tree_1_1_tree_node.html#a4884c49733bb5cf44f6d3f7fd796250e">Name</a> = this.<a class="code" href="class_phylo_tree_1_1_tree_node.html#a4884c49733bb5cf44f6d3f7fd796250e">Name</a>;</div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;                    <span class="keywordflow">return</span> child1;</div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;                }</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;            }</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;        }</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;<span class="comment">        /// &lt;summary&gt;</span></div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;<span class="comment">        /// Get a version of the tree that is rooted at the specified point of the branch leading to the &lt;paramref name=&quot;outgroup&quot;/&gt;.</span></div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;<span class="comment">        /// &lt;/summary&gt;</span></div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;<span class="comment">        /// &lt;param name=&quot;outgroup&quot;&gt;The outgroup to be used when rooting the tree.&lt;/param&gt;</span></div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;<span class="comment">        /// &lt;param name=&quot;position&quot;&gt;The (relative) position on the branch connecting the outgroup to the rest of the tree on which to place the root.&lt;/param&gt;</span></div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;<span class="comment">        /// &lt;returns&gt;A &lt;see cref=&quot;TreeNode&quot;/&gt; containing the rooted tree.&lt;/returns&gt;</span></div>
<div class="line"><a name="l00444"></a><span class="lineno"><a class="line" href="class_phylo_tree_1_1_tree_node.html#ae6b9afc19b73b1e44638704f02156976">  444</a></span>&#160;<span class="comment"></span>        <span class="keyword">public</span> <a class="code" href="class_phylo_tree_1_1_tree_node.html">TreeNode</a> <a class="code" href="class_phylo_tree_1_1_tree_node.html#ae6b9afc19b73b1e44638704f02156976">GetRootedTree</a>(<a class="code" href="class_phylo_tree_1_1_tree_node.html">TreeNode</a> outgroup, <span class="keywordtype">double</span> position = 0.5)</div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;        {</div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;            <span class="keywordflow">if</span> (outgroup != <span class="keyword">null</span> &amp;&amp; outgroup.<a class="code" href="class_phylo_tree_1_1_tree_node.html#ad013d0a85374f6055b067d21ec455aa8">Parent</a> != <span class="keyword">null</span>)</div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;            {</div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;                <a class="code" href="class_phylo_tree_1_1_tree_node.html">TreeNode</a> subject;</div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160; </div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;                <span class="keywordflow">if</span> (this.<a class="code" href="class_phylo_tree_1_1_tree_node.html#a0ea3341e47207ba0fc9d2262eef7f681">Children</a>.Count &lt; 3)</div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;                {</div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;                    subject = this.<a class="code" href="class_phylo_tree_1_1_tree_node.html#a17dbe72e48873a91dea484509fd636f6">GetUnrootedTree</a>();</div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;                }</div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;                <span class="keywordflow">else</span></div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;                {</div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;                    subject = this.<a class="code" href="class_phylo_tree_1_1_tree_node.html#aa0016b82b80aded16c7c91a172d0c7a6">Clone</a>();</div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;                }</div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160; </div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;                outgroup = subject.<a class="code" href="class_phylo_tree_1_1_tree_node.html#a5b10a1f2732bece732618a1ce000b0f1">GetNodeFromId</a>(outgroup.<a class="code" href="class_phylo_tree_1_1_tree_node.html#a4ef1e16b6ce765e8c54ff1ec32fb68a0">Id</a>);</div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160; </div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;                <span class="keywordflow">if</span> (outgroup != <span class="keyword">null</span> &amp;&amp; outgroup.<a class="code" href="class_phylo_tree_1_1_tree_node.html#ad013d0a85374f6055b067d21ec455aa8">Parent</a> != <span class="keyword">null</span>)</div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;                {</div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160; </div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;                    position = outgroup.<a class="code" href="class_phylo_tree_1_1_tree_node.html#a86b94683f7e5ba653601ad8068945e69">Length</a> * position;</div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160; </div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;                    <a class="code" href="class_phylo_tree_1_1_tree_node.html">TreeNode</a> tbr = <span class="keyword">new</span> <a class="code" href="class_phylo_tree_1_1_tree_node.html#af46398d315eaa6c973f21655baed8030">TreeNode</a>(<span class="keyword">null</span>);</div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160; </div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;                    <a class="code" href="class_phylo_tree_1_1_tree_node.html">TreeNode</a> outGroup2 = outgroup.<a class="code" href="class_phylo_tree_1_1_tree_node.html#aa0016b82b80aded16c7c91a172d0c7a6">Clone</a>();</div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;                    outGroup2.<a class="code" href="class_phylo_tree_1_1_tree_node.html#ad013d0a85374f6055b067d21ec455aa8">Parent</a> = tbr;</div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;                    outGroup2.<a class="code" href="class_phylo_tree_1_1_tree_node.html#a86b94683f7e5ba653601ad8068945e69">Length</a> = position;</div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;                    tbr.<a class="code" href="class_phylo_tree_1_1_tree_node.html#a0ea3341e47207ba0fc9d2262eef7f681">Children</a>.Add(outGroup2);</div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160; </div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;                    <a class="code" href="class_phylo_tree_1_1_tree_node.html">TreeNode</a> otherChild = outgroup.<a class="code" href="class_phylo_tree_1_1_tree_node.html#ad013d0a85374f6055b067d21ec455aa8">Parent</a>.Invert(outgroup);</div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;                    otherChild.<a class="code" href="class_phylo_tree_1_1_tree_node.html#ad013d0a85374f6055b067d21ec455aa8">Parent</a> = tbr;</div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;                    otherChild.<a class="code" href="class_phylo_tree_1_1_tree_node.html#a86b94683f7e5ba653601ad8068945e69">Length</a> = outgroup.<a class="code" href="class_phylo_tree_1_1_tree_node.html#a86b94683f7e5ba653601ad8068945e69">Length</a> - position;</div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;                    tbr.<a class="code" href="class_phylo_tree_1_1_tree_node.html#a0ea3341e47207ba0fc9d2262eef7f681">Children</a>.Add(otherChild);</div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160; </div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;                    <span class="keywordflow">foreach</span> (KeyValuePair&lt;string, object&gt; attribute <span class="keywordflow">in</span> this.<a class="code" href="class_phylo_tree_1_1_tree_node.html#a27ac3f4d53bdbc14e0b45ada083407ec">Attributes</a>)</div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;                    {</div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;                        tbr.Attributes[attribute.Key] = attribute.Value;</div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;                    }</div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160; </div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;                    tbr.Name = this.<a class="code" href="class_phylo_tree_1_1_tree_node.html#a4884c49733bb5cf44f6d3f7fd796250e">Name</a>;</div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160; </div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;                    <span class="keywordflow">return</span> tbr;</div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;                }</div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;                <span class="keywordflow">else</span></div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;                {</div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;                    <span class="keywordflow">return</span> this.<a class="code" href="class_phylo_tree_1_1_tree_node.html#aa0016b82b80aded16c7c91a172d0c7a6">Clone</a>();</div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;                }</div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;            }</div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;            {</div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;                <span class="keywordflow">return</span> this.<a class="code" href="class_phylo_tree_1_1_tree_node.html#aa0016b82b80aded16c7c91a172d0c7a6">Clone</a>();</div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;            }</div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;        }</div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160; </div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;        <span class="keyword">internal</span> <a class="code" href="class_phylo_tree_1_1_tree_node.html">TreeNode</a> Invert(<a class="code" href="class_phylo_tree_1_1_tree_node.html">TreeNode</a> ignoredChild)</div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;        {</div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;            <span class="keywordflow">if</span> (this.<a class="code" href="class_phylo_tree_1_1_tree_node.html#a0ea3341e47207ba0fc9d2262eef7f681">Children</a>.Count &lt; 2)</div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;            {</div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;                <span class="keywordflow">return</span> this.<a class="code" href="class_phylo_tree_1_1_tree_node.html#aa0016b82b80aded16c7c91a172d0c7a6">Clone</a>();</div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;            }</div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;            {</div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;                <a class="code" href="class_phylo_tree_1_1_tree_node.html#af46398d315eaa6c973f21655baed8030">TreeNode</a> nd = <span class="keyword">new</span> <a class="code" href="class_phylo_tree_1_1_tree_node.html#af46398d315eaa6c973f21655baed8030">TreeNode</a>(<span class="keyword">null</span>);</div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;                <span class="keywordflow">foreach</span> (<a class="code" href="class_phylo_tree_1_1_tree_node.html#af46398d315eaa6c973f21655baed8030">TreeNode</a> chd <span class="keywordflow">in</span> this.<a class="code" href="class_phylo_tree_1_1_tree_node.html#a0ea3341e47207ba0fc9d2262eef7f681">Children</a>)</div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;                {</div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;                    <span class="keywordflow">if</span> (chd != ignoredChild)</div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;                    {</div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;                        <a class="code" href="class_phylo_tree_1_1_tree_node.html#af46398d315eaa6c973f21655baed8030">TreeNode</a> chd2 = chd.Clone();</div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;                        chd2.Parent = nd;</div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;                        nd.Children.Add(chd2);</div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;                    }</div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;                }</div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160; </div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;                <span class="keywordflow">if</span> (this.<a class="code" href="class_phylo_tree_1_1_tree_node.html#ad013d0a85374f6055b067d21ec455aa8">Parent</a> != <span class="keyword">null</span>)</div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;                {</div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;                    <a class="code" href="class_phylo_tree_1_1_tree_node.html#af46398d315eaa6c973f21655baed8030">TreeNode</a> prnt = this.<a class="code" href="class_phylo_tree_1_1_tree_node.html#ad013d0a85374f6055b067d21ec455aa8">Parent</a>.Invert(<span class="keyword">this</span>);</div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;                    prnt.<a class="code" href="class_phylo_tree_1_1_tree_node.html#ad013d0a85374f6055b067d21ec455aa8">Parent</a> = nd;</div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160; </div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;                    <span class="keywordflow">foreach</span> (KeyValuePair&lt;string, object&gt; attribute <span class="keywordflow">in</span> this.<a class="code" href="class_phylo_tree_1_1_tree_node.html#a27ac3f4d53bdbc14e0b45ada083407ec">Attributes</a>)</div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;                    {</div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;                        prnt.<a class="code" href="class_phylo_tree_1_1_tree_node.html#a27ac3f4d53bdbc14e0b45ada083407ec">Attributes</a>[attribute.Key] = attribute.Value;</div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;                    }</div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160; </div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;                    prnt.<a class="code" href="class_phylo_tree_1_1_attribute_dictionary.html#a018e1cb442e42860a608ae4182282146">Name</a> = this.<a class="code" href="class_phylo_tree_1_1_tree_node.html#a4884c49733bb5cf44f6d3f7fd796250e">Name</a>;</div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;                    prnt.Length = this.<a class="code" href="class_phylo_tree_1_1_tree_node.html#a86b94683f7e5ba653601ad8068945e69">Length</a>;</div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;                    prnt.Support = this.<a class="code" href="class_phylo_tree_1_1_tree_node.html#a3ab120b9c1bc00902321bb42fcd81225">Support</a>;</div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160; </div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;                    nd.Children.Add(prnt);</div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;                }</div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;                <span class="keywordflow">else</span></div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;                {</div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;                    <span class="keywordflow">foreach</span> (KeyValuePair&lt;string, object&gt; attribute <span class="keywordflow">in</span> this.Attributes)</div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;                    {</div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;                        nd.Attributes[attribute.Key] = attribute.Value;</div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;                    }</div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160; </div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;                    nd.Name = this.<a class="code" href="class_phylo_tree_1_1_tree_node.html#a4884c49733bb5cf44f6d3f7fd796250e">Name</a>;</div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;                    nd.Length = this.<a class="code" href="class_phylo_tree_1_1_tree_node.html#a86b94683f7e5ba653601ad8068945e69">Length</a>;</div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;                    nd.Support = this.<a class="code" href="class_phylo_tree_1_1_tree_node.html#a3ab120b9c1bc00902321bb42fcd81225">Support</a>;</div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;                }</div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160; </div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;                <span class="keywordflow">return</span> nd;</div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;            }</div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;        }</div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;<span class="comment">        /// &lt;summary&gt;</span></div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;<span class="comment">        /// Recursively clone a &lt;see cref=&quot;TreeNode&quot;/&gt; object.</span></div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;<span class="comment">        /// &lt;/summary&gt;</span></div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;<span class="comment">        /// &lt;returns&gt;The cloned &lt;see cref=&quot;TreeNode&quot;/&gt;&lt;/returns&gt;</span></div>
<div class="line"><a name="l00553"></a><span class="lineno"><a class="line" href="class_phylo_tree_1_1_tree_node.html#aa0016b82b80aded16c7c91a172d0c7a6">  553</a></span>&#160;<span class="comment"></span>        <span class="keyword">public</span> <a class="code" href="class_phylo_tree_1_1_tree_node.html">TreeNode</a> <a class="code" href="class_phylo_tree_1_1_tree_node.html#aa0016b82b80aded16c7c91a172d0c7a6">Clone</a>()</div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;        {</div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;            <a class="code" href="class_phylo_tree_1_1_tree_node.html">TreeNode</a> nd = <span class="keyword">new</span> <a class="code" href="class_phylo_tree_1_1_tree_node.html#af46398d315eaa6c973f21655baed8030">TreeNode</a>(this.<a class="code" href="class_phylo_tree_1_1_tree_node.html#ad013d0a85374f6055b067d21ec455aa8">Parent</a>)</div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;            {</div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;                <a class="code" href="class_phylo_tree_1_1_tree_node.html#a4ef1e16b6ce765e8c54ff1ec32fb68a0">Id</a> = this.<a class="code" href="class_phylo_tree_1_1_tree_node.html#a4ef1e16b6ce765e8c54ff1ec32fb68a0">Id</a>,</div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;                <a class="code" href="class_phylo_tree_1_1_tree_node.html#a4884c49733bb5cf44f6d3f7fd796250e">Name</a> = this.Name</div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;            };</div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160; </div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;            <span class="keywordflow">foreach</span> (<a class="code" href="class_phylo_tree_1_1_tree_node.html">TreeNode</a> nd2 <span class="keywordflow">in</span> this.Children)</div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;            {</div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;                <a class="code" href="class_phylo_tree_1_1_tree_node.html">TreeNode</a> nd22 = nd2.<a class="code" href="class_phylo_tree_1_1_tree_node.html#aa0016b82b80aded16c7c91a172d0c7a6">Clone</a>();</div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;                nd22.<a class="code" href="class_phylo_tree_1_1_tree_node.html#ad013d0a85374f6055b067d21ec455aa8">Parent</a> = nd;</div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;                nd.<a class="code" href="class_phylo_tree_1_1_tree_node.html#a0ea3341e47207ba0fc9d2262eef7f681">Children</a>.Add(nd22);</div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;            }</div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160; </div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;            nd.Length = this.<a class="code" href="class_phylo_tree_1_1_tree_node.html#a86b94683f7e5ba653601ad8068945e69">Length</a>;</div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;            nd.Support = this.<a class="code" href="class_phylo_tree_1_1_tree_node.html#a3ab120b9c1bc00902321bb42fcd81225">Support</a>;</div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160; </div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;            <span class="keywordflow">foreach</span> (KeyValuePair&lt;string, object&gt; kvp <span class="keywordflow">in</span> this.<a class="code" href="class_phylo_tree_1_1_tree_node.html#a27ac3f4d53bdbc14e0b45ada083407ec">Attributes</a>)</div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;            {</div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;                nd.Attributes[kvp.Key] = kvp.Value;</div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;            }</div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160; </div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;            <span class="keywordflow">return</span> nd;</div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;        }</div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;<span class="comment">        /// &lt;summary&gt;</span></div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;<span class="comment">        /// Recursively get all the nodes that descend from this node.</span></div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;<span class="comment">        /// &lt;/summary&gt;</span></div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;<span class="comment">        /// &lt;returns&gt;A &lt;see cref=&quot;List{T}&quot;/&gt; of &lt;see cref=&quot;TreeNode&quot;/&gt; objects, containing the nodes that descend from this node.&lt;/returns&gt;</span></div>
<div class="line"><a name="l00583"></a><span class="lineno"><a class="line" href="class_phylo_tree_1_1_tree_node.html#a10f3cbaa55715ca0c062ad6aee626e0f">  583</a></span>&#160;<span class="comment"></span>        <span class="keyword">public</span> List&lt;TreeNode&gt; <a class="code" href="class_phylo_tree_1_1_tree_node.html#a10f3cbaa55715ca0c062ad6aee626e0f">GetChildrenRecursive</a>()</div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;        {</div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;            List&lt;TreeNode&gt; tbr = <span class="keyword">new</span> List&lt;TreeNode&gt;</div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;            {</div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;                <span class="keyword">this</span></div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;            };</div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160; </div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; this.Children.Count; i++)</div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;            {</div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;                tbr.AddRange(this.Children[i].<a class="code" href="class_phylo_tree_1_1_tree_node.html#a10f3cbaa55715ca0c062ad6aee626e0f">GetChildrenRecursive</a>());</div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;            }</div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;            <span class="keywordflow">return</span> tbr;</div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;        }</div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;<span class="comment">        /// &lt;summary&gt;</span></div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;<span class="comment">        /// Lazily recursively get all the nodes that descend from this node.</span></div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;<span class="comment">        /// &lt;/summary&gt;</span></div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;<span class="comment">        /// &lt;returns&gt;An &lt;see cref=&quot;IEnumerable{T}&quot;/&gt; of &lt;see cref=&quot;TreeNode&quot;/&gt; objects, containing the nodes that descend from this node.&lt;/returns&gt;</span></div>
<div class="line"><a name="l00601"></a><span class="lineno"><a class="line" href="class_phylo_tree_1_1_tree_node.html#acd4a745d36fedcf6fc283edf113d0408">  601</a></span>&#160;<span class="comment"></span>        <span class="keyword">public</span> IEnumerable&lt;TreeNode&gt; <a class="code" href="class_phylo_tree_1_1_tree_node.html#acd4a745d36fedcf6fc283edf113d0408">GetChildrenRecursiveLazy</a>()</div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;        {</div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;            yield <span class="keywordflow">return</span> <span class="keyword">this</span>;</div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160; </div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; this.Children.Count; i++)</div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;            {</div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;                <span class="keywordflow">foreach</span> (<a class="code" href="class_phylo_tree_1_1_tree_node.html">TreeNode</a> t <span class="keywordflow">in</span> this.Children[i].<a class="code" href="class_phylo_tree_1_1_tree_node.html#acd4a745d36fedcf6fc283edf113d0408">GetChildrenRecursiveLazy</a>())</div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;                {</div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;                    yield <span class="keywordflow">return</span> t;</div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;                }</div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;            }</div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;        }</div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;<span class="comment">        /// &lt;summary&gt;</span></div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;<span class="comment">        /// Get all the leaves that descend (directly or indirectly) from this node.</span></div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;<span class="comment">        /// &lt;/summary&gt;</span></div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;<span class="comment">        /// &lt;returns&gt;A &lt;see cref=&quot;List{T}&quot;/&gt; of &lt;see cref=&quot;TreeNode&quot;/&gt; objects, containing the leaves that descend from this node.&lt;/returns&gt;</span></div>
<div class="line"><a name="l00618"></a><span class="lineno"><a class="line" href="class_phylo_tree_1_1_tree_node.html#abd6553ee2108df823c68b7bd066402c1">  618</a></span>&#160;<span class="comment"></span>        <span class="keyword">public</span> List&lt;TreeNode&gt; <a class="code" href="class_phylo_tree_1_1_tree_node.html#abd6553ee2108df823c68b7bd066402c1">GetLeaves</a>()</div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;        {</div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;            List&lt;TreeNode&gt; tbr = <span class="keyword">new</span> List&lt;TreeNode&gt;();</div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160; </div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;            <span class="keywordflow">if</span> (this.Children.Count == 0)</div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;            {</div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;                tbr.Add(<span class="keyword">this</span>);</div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;            }</div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160; </div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; this.Children.Count; i++)</div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;            {</div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;                tbr.AddRange(this.Children[i].<a class="code" href="class_phylo_tree_1_1_tree_node.html#abd6553ee2108df823c68b7bd066402c1">GetLeaves</a>());</div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;            }</div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;            <span class="keywordflow">return</span> tbr;</div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;        }</div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;<span class="comment">        /// &lt;summary&gt;</span></div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;<span class="comment">        /// Get the names of all the leaves that descend (directly or indirectly) from this node.</span></div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;<span class="comment">        /// &lt;/summary&gt;</span></div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;<span class="comment">        /// &lt;returns&gt;A &lt;see cref=&quot;List{T}&quot;/&gt; of &lt;see cref=&quot;string&quot;/&gt;s, containing the names of the leaves that descend from this node.&lt;/returns&gt;</span></div>
<div class="line"><a name="l00638"></a><span class="lineno"><a class="line" href="class_phylo_tree_1_1_tree_node.html#a8106a348a92ec008a280673485461ab1">  638</a></span>&#160;<span class="comment"></span>        <span class="keyword">public</span> List&lt;string&gt; <a class="code" href="class_phylo_tree_1_1_tree_node.html#a8106a348a92ec008a280673485461ab1">GetLeafNames</a>()</div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;        {</div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;            List&lt;string&gt; tbr = <span class="keyword">new</span> List&lt;string&gt;();</div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160; </div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;            <span class="keywordflow">if</span> (this.Children.Count == 0 &amp;&amp; !<span class="keywordtype">string</span>.IsNullOrEmpty(<span class="keyword">this</span>.Name))</div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;            {</div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;                tbr.Add(this.<a class="code" href="class_phylo_tree_1_1_tree_node.html#a4884c49733bb5cf44f6d3f7fd796250e">Name</a>);</div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;            }</div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160; </div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; this.Children.Count; i++)</div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;            {</div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;                tbr.AddRange(this.Children[i].<a class="code" href="class_phylo_tree_1_1_tree_node.html#a8106a348a92ec008a280673485461ab1">GetLeafNames</a>());</div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;            }</div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;            <span class="keywordflow">return</span> tbr;</div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;        }</div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;<span class="comment">        /// &lt;summary&gt;</span></div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;<span class="comment">        /// Get the names of all the named nodes that descend (directly or indirectly) from this node.</span></div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;<span class="comment">        /// &lt;/summary&gt;</span></div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;<span class="comment">        /// &lt;returns&gt;A &lt;see cref=&quot;List{T}&quot;/&gt; of &lt;see cref=&quot;string&quot;/&gt;s, containing the names of the named nodes that descend from this node.&lt;/returns&gt;</span></div>
<div class="line"><a name="l00658"></a><span class="lineno"><a class="line" href="class_phylo_tree_1_1_tree_node.html#a0190778929ce3b54ac2be351dd62bb78">  658</a></span>&#160;<span class="comment"></span>        <span class="keyword">public</span> List&lt;string&gt; <a class="code" href="class_phylo_tree_1_1_tree_node.html#a0190778929ce3b54ac2be351dd62bb78">GetNodeNames</a>()</div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;        {</div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;            List&lt;string&gt; tbr = <span class="keyword">new</span> List&lt;string&gt;();</div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160; </div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;            <span class="keywordflow">if</span> (!<span class="keywordtype">string</span>.IsNullOrEmpty(this.<a class="code" href="class_phylo_tree_1_1_tree_node.html#a4884c49733bb5cf44f6d3f7fd796250e">Name</a>))</div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;            {</div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;                tbr.Add(this.<a class="code" href="class_phylo_tree_1_1_tree_node.html#a4884c49733bb5cf44f6d3f7fd796250e">Name</a>);</div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;            }</div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160; </div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; this.Children.Count; i++)</div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;            {</div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;                tbr.AddRange(this.Children[i].<a class="code" href="class_phylo_tree_1_1_tree_node.html#a0190778929ce3b54ac2be351dd62bb78">GetNodeNames</a>());</div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;            }</div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;            <span class="keywordflow">return</span> tbr;</div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;        }</div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;<span class="comment">        /// &lt;summary&gt;</span></div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;<span class="comment">        /// Get the child node with the specified name.</span></div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;<span class="comment">        /// &lt;/summary&gt;</span></div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;<span class="comment">        /// &lt;param name=&quot;nodeName&quot;&gt;The name of the node to search.&lt;/param&gt;</span></div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;<span class="comment">        /// &lt;returns&gt;The &lt;see cref=&quot;TreeNode&quot;/&gt; object with the specified name, or &lt;c&gt;null&lt;/c&gt; if no node with such name exists.&lt;/returns&gt;</span></div>
<div class="line"><a name="l00679"></a><span class="lineno"><a class="line" href="class_phylo_tree_1_1_tree_node.html#af6f61b610664c8de60f2622420318f69">  679</a></span>&#160;<span class="comment"></span>        <span class="keyword">public</span> <a class="code" href="class_phylo_tree_1_1_tree_node.html">TreeNode</a> <a class="code" href="class_phylo_tree_1_1_tree_node.html#af6f61b610664c8de60f2622420318f69">GetNodeFromName</a>(<span class="keywordtype">string</span> nodeName)</div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;        {</div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;            <span class="keywordflow">if</span> (this.<a class="code" href="class_phylo_tree_1_1_tree_node.html#a4884c49733bb5cf44f6d3f7fd796250e">Name</a> == nodeName)</div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;            {</div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;                <span class="keywordflow">return</span> <span class="keyword">this</span>;</div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;            }</div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160; </div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; this.Children.Count; i++)</div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;            {</div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;                <a class="code" href="class_phylo_tree_1_1_tree_node.html">TreeNode</a> item = this.Children[i].<a class="code" href="class_phylo_tree_1_1_tree_node.html#af6f61b610664c8de60f2622420318f69">GetNodeFromName</a>(nodeName);</div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;                <span class="keywordflow">if</span> (item != <span class="keyword">null</span>)</div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;                {</div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;                    <span class="keywordflow">return</span> item;</div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;                }</div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;            }</div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160; </div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">null</span>;</div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;        }</div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;<span class="comment">        /// &lt;summary&gt;</span></div>
<div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;<span class="comment">        /// Get the child node with the specified Id.</span></div>
<div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;<span class="comment">        /// &lt;/summary&gt;</span></div>
<div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;<span class="comment">        /// &lt;param name=&quot;nodeId&quot;&gt;The Id of the node to search.&lt;/param&gt;</span></div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;<span class="comment">        /// &lt;returns&gt;The &lt;see cref=&quot;TreeNode&quot;/&gt; object with the specified Id, or &lt;c&gt;null&lt;/c&gt; if no node with such Id exists.&lt;/returns&gt;</span></div>
<div class="line"><a name="l00703"></a><span class="lineno"><a class="line" href="class_phylo_tree_1_1_tree_node.html#a5b10a1f2732bece732618a1ce000b0f1">  703</a></span>&#160;<span class="comment"></span>        <span class="keyword">public</span> <a class="code" href="class_phylo_tree_1_1_tree_node.html">TreeNode</a> <a class="code" href="class_phylo_tree_1_1_tree_node.html#a5b10a1f2732bece732618a1ce000b0f1">GetNodeFromId</a>(<span class="keywordtype">string</span> nodeId)</div>
<div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;        {</div>
<div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;            <span class="keywordflow">if</span> (this.<a class="code" href="class_phylo_tree_1_1_tree_node.html#a4ef1e16b6ce765e8c54ff1ec32fb68a0">Id</a> == nodeId)</div>
<div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;            {</div>
<div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;                <span class="keywordflow">return</span> <span class="keyword">this</span>;</div>
<div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;            }</div>
<div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160; </div>
<div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; this.Children.Count; i++)</div>
<div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;            {</div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;                <a class="code" href="class_phylo_tree_1_1_tree_node.html">TreeNode</a> item = this.Children[i].<a class="code" href="class_phylo_tree_1_1_tree_node.html#a5b10a1f2732bece732618a1ce000b0f1">GetNodeFromId</a>(nodeId);</div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;                <span class="keywordflow">if</span> (item != <span class="keyword">null</span>)</div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;                {</div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;                    <span class="keywordflow">return</span> item;</div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;                }</div>
<div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;            }</div>
<div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160; </div>
<div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">null</span>;</div>
<div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;        }</div>
<div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;<span class="comment">        /// &lt;summary&gt;</span></div>
<div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;<span class="comment">        /// Get the sum of the branch lengths from this node up to the root.</span></div>
<div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;<span class="comment">        /// &lt;/summary&gt;</span></div>
<div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;<span class="comment">        /// &lt;returns&gt;The sum of the branch lengths from this node up to the root.&lt;/returns&gt;</span></div>
<div class="line"><a name="l00726"></a><span class="lineno"><a class="line" href="class_phylo_tree_1_1_tree_node.html#a4ce9baade2f082764a748b65a7564d55">  726</a></span>&#160;<span class="comment"></span>        <span class="keyword">public</span> <span class="keywordtype">double</span> <a class="code" href="class_phylo_tree_1_1_tree_node.html#a4ce9baade2f082764a748b65a7564d55">UpstreamLength</a>()</div>
<div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;        {</div>
<div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;            <span class="keywordtype">double</span> tbr = 0;</div>
<div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160; </div>
<div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;            <a class="code" href="class_phylo_tree_1_1_tree_node.html">TreeNode</a> nd = <span class="keyword">this</span>;</div>
<div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160; </div>
<div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;            <span class="keywordflow">while</span> (nd.<a class="code" href="class_phylo_tree_1_1_tree_node.html#ad013d0a85374f6055b067d21ec455aa8">Parent</a> != <span class="keyword">null</span>)</div>
<div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;            {</div>
<div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;                tbr += nd.<a class="code" href="class_phylo_tree_1_1_tree_node.html#a86b94683f7e5ba653601ad8068945e69">Length</a>;</div>
<div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;                nd = nd.<a class="code" href="class_phylo_tree_1_1_tree_node.html#ad013d0a85374f6055b067d21ec455aa8">Parent</a>;</div>
<div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;            }</div>
<div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160; </div>
<div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;            <span class="keywordflow">return</span> tbr;</div>
<div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;        }</div>
<div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;<span class="comment">        /// &lt;summary&gt;</span></div>
<div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;<span class="comment">        /// Get the sum of the branch lengths from this node down to the leaves of the tree. If the tree is not clock-like, the length of the longest path is returned.</span></div>
<div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;<span class="comment">        /// &lt;/summary&gt;</span></div>
<div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;<span class="comment">        /// &lt;returns&gt;The sum of the branch lengths from this node down to the leaves of the tree. If the tree is not clock-like, the length of the longest path is returned.&lt;/returns&gt;</span></div>
<div class="line"><a name="l00745"></a><span class="lineno"><a class="line" href="class_phylo_tree_1_1_tree_node.html#a30ca619e43389b3c2c0e30e01722393c">  745</a></span>&#160;<span class="comment"></span>        <span class="keyword">public</span> <span class="keywordtype">double</span> <a class="code" href="class_phylo_tree_1_1_tree_node.html#a30ca619e43389b3c2c0e30e01722393c">LongestDownstreamLength</a>()</div>
<div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;        {</div>
<div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;            <span class="keywordflow">if</span> (this.Children.Count == 0)</div>
<div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;            {</div>
<div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;                <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;            }</div>
<div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;            {</div>
<div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;                <span class="keywordtype">double</span> maxLen = 0;</div>
<div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; this.Children.Count; i++)</div>
<div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;                {</div>
<div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;                    <span class="keywordtype">double</span> chLen = this.Children[i].LongestDownstreamLength() + this.Children[i].Length;</div>
<div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160; </div>
<div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;                    maxLen = Math.Max(maxLen, chLen);</div>
<div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;                }</div>
<div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160; </div>
<div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;                <span class="keywordflow">return</span> maxLen;</div>
<div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;            }</div>
<div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;        }</div>
<div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;<span class="comment">        /// &lt;summary&gt;</span></div>
<div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;<span class="comment">        /// Get the sum of the branch lengths from this node down to the leaves of the tree. If the tree is not clock-like, the length of the shortest path is returned.</span></div>
<div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;<span class="comment">        /// &lt;/summary&gt;</span></div>
<div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;<span class="comment">        /// &lt;returns&gt;The sum of the branch lengths from this node down to the leaves of the tree. If the tree is not clock-like, the length of the shortest path is returned.&lt;/returns&gt;</span></div>
<div class="line"><a name="l00769"></a><span class="lineno"><a class="line" href="class_phylo_tree_1_1_tree_node.html#a0112912c88ce3b62c11a5352de9ebaab">  769</a></span>&#160;<span class="comment"></span>        <span class="keyword">public</span> <span class="keywordtype">double</span> <a class="code" href="class_phylo_tree_1_1_tree_node.html#a0112912c88ce3b62c11a5352de9ebaab">ShortestDownstreamLength</a>()</div>
<div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;        {</div>
<div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;            <span class="keywordflow">if</span> (this.Children.Count == 0)</div>
<div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;            {</div>
<div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;                <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;            }</div>
<div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;            {</div>
<div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;                <span class="keywordtype">double</span> minLen = <span class="keywordtype">double</span>.MaxValue;</div>
<div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; this.Children.Count; i++)</div>
<div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;                {</div>
<div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;                    <span class="keywordtype">double</span> chLen = this.Children[i].ShortestDownstreamLength() + this.Children[i].Length;</div>
<div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160; </div>
<div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;                    minLen = Math.Min(minLen, chLen);</div>
<div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;                }</div>
<div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160; </div>
<div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;                <span class="keywordflow">return</span> minLen;</div>
<div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;            }</div>
<div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;        }</div>
<div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;<span class="comment">        /// &lt;summary&gt;</span></div>
<div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;<span class="comment">        /// Get the node of the tree from which all other nodes descend.</span></div>
<div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;<span class="comment">        /// &lt;/summary&gt;</span></div>
<div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;<span class="comment">        /// &lt;returns&gt;The node of the tree from which all other nodes descend&lt;/returns&gt;</span></div>
<div class="line"><a name="l00793"></a><span class="lineno"><a class="line" href="class_phylo_tree_1_1_tree_node.html#af08b6ddc4fdf955f91e53a6ca7554538">  793</a></span>&#160;<span class="comment"></span>        <span class="keyword">public</span> <a class="code" href="class_phylo_tree_1_1_tree_node.html">TreeNode</a> <a class="code" href="class_phylo_tree_1_1_tree_node.html#af08b6ddc4fdf955f91e53a6ca7554538">GetRootNode</a>()</div>
<div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;        {</div>
<div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;            <a class="code" href="class_phylo_tree_1_1_tree_node.html">TreeNode</a> parent = <span class="keyword">this</span>;</div>
<div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;            <span class="keywordflow">while</span> (parent.<a class="code" href="class_phylo_tree_1_1_tree_node.html#ad013d0a85374f6055b067d21ec455aa8">Parent</a> != <span class="keyword">null</span>)</div>
<div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;            {</div>
<div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;                parent = parent.<a class="code" href="class_phylo_tree_1_1_tree_node.html#ad013d0a85374f6055b067d21ec455aa8">Parent</a>;</div>
<div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;            }</div>
<div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;            <span class="keywordflow">return</span> parent;</div>
<div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;        }</div>
<div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;<span class="comment">        /// &lt;summary&gt;</span></div>
<div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;<span class="comment">        /// Describes the relationship between two nodes.</span></div>
<div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;<span class="comment">        /// &lt;/summary&gt;</span></div>
<div class="line"><a name="l00806"></a><span class="lineno"><a class="line" href="class_phylo_tree_1_1_tree_node.html#afd3cbefbf37e7aaa6d3516bca73d8a07">  806</a></span>&#160;<span class="comment"></span>        <span class="keyword">public</span> <span class="keyword">enum</span> <a class="code" href="class_phylo_tree_1_1_tree_node.html#afd3cbefbf37e7aaa6d3516bca73d8a07">NodeRelationship</a></div>
<div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;        {<span class="comment"></span></div>
<div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;<span class="comment">            /// &lt;summary&gt;</span></div>
<div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;<span class="comment">            /// The relationship between the nodes is unknown.</span></div>
<div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;<span class="comment">            /// &lt;/summary&gt;</span></div>
<div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;<span class="comment"></span>            Unknown,</div>
<div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;<span class="comment">            /// &lt;summary&gt;</span></div>
<div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;<span class="comment">            /// The first node is an ancestor of the second node.</span></div>
<div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;<span class="comment">            /// &lt;/summary&gt;</span></div>
<div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;<span class="comment"></span>            Ancestor,</div>
<div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;<span class="comment">            /// &lt;summary&gt;</span></div>
<div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;<span class="comment">            /// The first node is a descendant of the second node.</span></div>
<div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;<span class="comment">            /// &lt;/summary&gt;</span></div>
<div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;<span class="comment"></span>            Descendant,</div>
<div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;<span class="comment">            /// &lt;summary&gt;</span></div>
<div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;<span class="comment">            /// The two nodes are relatives (i.e. they share a common ancestor which is neither one of them).</span></div>
<div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;<span class="comment">            /// &lt;/summary&gt;</span></div>
<div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;<span class="comment"></span>            Relatives</div>
<div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;        }</div>
<div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;<span class="comment">        /// &lt;summary&gt;</span></div>
<div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;<span class="comment">        /// Get the sum of the branch lengths from this node to the specified node.</span></div>
<div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;<span class="comment">        /// &lt;/summary&gt;</span></div>
<div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;<span class="comment">        /// &lt;param name=&quot;otherNode&quot;&gt;The node that should be reached&lt;/param&gt;</span></div>
<div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;<span class="comment">        /// &lt;param name=&quot;nodeRelationship&quot;&gt;A value indicating how this node is related to &lt;paramref name=&quot;otherNode&quot;/&gt;.&lt;/param&gt;</span></div>
<div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;<span class="comment">        /// &lt;returns&gt;The sum of the branch lengths from this node to the specified node.&lt;/returns&gt;</span></div>
<div class="line"><a name="l00835"></a><span class="lineno"><a class="line" href="class_phylo_tree_1_1_tree_node.html#a2aa5546576de0f2f76e0c1ff7477a63d">  835</a></span>&#160;<span class="comment"></span>        <span class="keyword">public</span> <span class="keywordtype">double</span> <a class="code" href="class_phylo_tree_1_1_tree_node.html#a2aa5546576de0f2f76e0c1ff7477a63d">PathLengthTo</a>(<a class="code" href="class_phylo_tree_1_1_tree_node.html">TreeNode</a> otherNode, <a class="code" href="class_phylo_tree_1_1_tree_node.html#afd3cbefbf37e7aaa6d3516bca73d8a07">NodeRelationship</a> nodeRelationship = <a class="code" href="class_phylo_tree_1_1_tree_node.html#afd3cbefbf37e7aaa6d3516bca73d8a07">NodeRelationship</a>.Unknown)</div>
<div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;        {</div>
<div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;            Contract.Requires(otherNode != <span class="keyword">null</span>);</div>
<div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160; </div>
<div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;            <a class="code" href="class_phylo_tree_1_1_tree_node.html">TreeNode</a> LCA = <span class="keyword">null</span>;</div>
<div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160; </div>
<div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;            <span class="keywordflow">if</span> (<span class="keyword">this</span> == otherNode)</div>
<div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;            {</div>
<div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;                <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;            }</div>
<div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160; </div>
<div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;            <span class="keywordflow">if</span> (nodeRelationship == <a class="code" href="class_phylo_tree_1_1_tree_node.html#afd3cbefbf37e7aaa6d3516bca73d8a07">NodeRelationship</a>.Unknown)</div>
<div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;            {</div>
<div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;                List&lt;TreeNode&gt; myChildren = this.<a class="code" href="class_phylo_tree_1_1_tree_node.html#a10f3cbaa55715ca0c062ad6aee626e0f">GetChildrenRecursive</a>();</div>
<div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;                <span class="keywordflow">if</span> (myChildren.Contains(otherNode))</div>
<div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;                {</div>
<div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;                    nodeRelationship = <a class="code" href="class_phylo_tree_1_1_tree_node.html#afd3cbefbf37e7aaa6d3516bca73d8a07">NodeRelationship</a>.Ancestor;</div>
<div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;                }</div>
<div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;                <span class="keywordflow">else</span></div>
<div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;                {</div>
<div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;                    List&lt;TreeNode&gt; otherChildren = otherNode.<a class="code" href="class_phylo_tree_1_1_tree_node.html#a10f3cbaa55715ca0c062ad6aee626e0f">GetChildrenRecursive</a>();</div>
<div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;                    <span class="keywordflow">if</span> (otherChildren.Contains(<span class="keyword">this</span>))</div>
<div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;                    {</div>
<div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;                        nodeRelationship = <a class="code" href="class_phylo_tree_1_1_tree_node.html#afd3cbefbf37e7aaa6d3516bca73d8a07">NodeRelationship</a>.Descendant;</div>
<div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;                    }</div>
<div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;                    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;                    {</div>
<div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;                        LCA = <a class="code" href="class_phylo_tree_1_1_tree_node.html#aa4a24b971f90ec80dc8dcac2d72756d7">GetLastCommonAncestor</a>(<span class="keyword">new</span> <a class="code" href="class_phylo_tree_1_1_tree_node.html">TreeNode</a>[] { <span class="keyword">this</span>, otherNode });</div>
<div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160; </div>
<div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;                        <span class="keywordflow">if</span> (LCA != <span class="keyword">null</span>)</div>
<div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;                        {</div>
<div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;                            nodeRelationship = <a class="code" href="class_phylo_tree_1_1_tree_node.html#afd3cbefbf37e7aaa6d3516bca73d8a07">NodeRelationship</a>.Relatives;</div>
<div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;                        }</div>
<div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;                        <span class="keywordflow">else</span></div>
<div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;                        {</div>
<div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;                            <span class="keywordflow">throw</span> <span class="keyword">new</span> InvalidOperationException(<span class="stringliteral">&quot;The two nodes do not belong to the same tree!&quot;</span>);</div>
<div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;                        }</div>
<div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;                    }</div>
<div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;                }</div>
<div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;            }</div>
<div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160; </div>
<div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;            <span class="keywordflow">switch</span> (nodeRelationship)</div>
<div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;            {</div>
<div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;                <span class="keywordflow">case</span> <a class="code" href="class_phylo_tree_1_1_tree_node.html#afd3cbefbf37e7aaa6d3516bca73d8a07">NodeRelationship</a>.Relatives:</div>
<div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;                    <span class="keywordflow">return</span> LCA.<a class="code" href="class_phylo_tree_1_1_tree_node.html#a2aa5546576de0f2f76e0c1ff7477a63d">PathLengthTo</a>(<span class="keyword">this</span>, <a class="code" href="class_phylo_tree_1_1_tree_node.html#afd3cbefbf37e7aaa6d3516bca73d8a07">NodeRelationship</a>.Ancestor) + LCA.<a class="code" href="class_phylo_tree_1_1_tree_node.html#a2aa5546576de0f2f76e0c1ff7477a63d">PathLengthTo</a>(otherNode, <a class="code" href="class_phylo_tree_1_1_tree_node.html#afd3cbefbf37e7aaa6d3516bca73d8a07">NodeRelationship</a>.Ancestor);</div>
<div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;                <span class="keywordflow">case</span> <a class="code" href="class_phylo_tree_1_1_tree_node.html#afd3cbefbf37e7aaa6d3516bca73d8a07">NodeRelationship</a>.Ancestor:</div>
<div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;                    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; this.Children.Count; i++)</div>
<div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;                    {</div>
<div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;                        <span class="keywordflow">if</span> (this.Children[i] == otherNode)</div>
<div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;                        {</div>
<div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;                            <span class="keywordflow">return</span> this.Children[i].Length;</div>
<div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;                        }</div>
<div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;                        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (this.Children[i].<a class="code" href="class_phylo_tree_1_1_tree_node.html#a10f3cbaa55715ca0c062ad6aee626e0f">GetChildrenRecursive</a>().Contains(otherNode))</div>
<div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;                        {</div>
<div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;                            <span class="keywordflow">return</span> this.Children[i].Length + this.Children[i].PathLengthTo(otherNode, <a class="code" href="class_phylo_tree_1_1_tree_node.html#afd3cbefbf37e7aaa6d3516bca73d8a07">NodeRelationship</a>.Ancestor);</div>
<div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;                        }</div>
<div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;                    }</div>
<div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;                    <span class="keywordflow">throw</span> <span class="keyword">new</span> InvalidOperationException(<span class="stringliteral">&quot;Unexpected code path!&quot;</span>);</div>
<div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;                <span class="keywordflow">case</span> <a class="code" href="class_phylo_tree_1_1_tree_node.html#afd3cbefbf37e7aaa6d3516bca73d8a07">NodeRelationship</a>.Descendant:</div>
<div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;                    <span class="keywordflow">return</span> otherNode.<a class="code" href="class_phylo_tree_1_1_tree_node.html#a2aa5546576de0f2f76e0c1ff7477a63d">PathLengthTo</a>(<span class="keyword">this</span>, <a class="code" href="class_phylo_tree_1_1_tree_node.html#afd3cbefbf37e7aaa6d3516bca73d8a07">NodeRelationship</a>.Ancestor);</div>
<div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;                <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;                    <span class="keywordflow">throw</span> <span class="keyword">new</span> InvalidOperationException(<span class="stringliteral">&quot;The two nodes do not belong to the same tree!&quot;</span>);</div>
<div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;            }</div>
<div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;        }</div>
<div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160; </div>
<div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;<span class="comment">        /// &lt;summary&gt;</span></div>
<div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;<span class="comment">        /// Get the sum of the branch lengths of this node and all its descendants.</span></div>
<div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;<span class="comment">        /// &lt;/summary&gt;</span></div>
<div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;<span class="comment">        /// &lt;returns&gt;The sum of the branch lengths of this node and all its descendants.&lt;/returns&gt;</span></div>
<div class="line"><a name="l00905"></a><span class="lineno"><a class="line" href="class_phylo_tree_1_1_tree_node.html#a0c8dc9e138bb0ccc6e1bd75a457b2a62">  905</a></span>&#160;<span class="comment"></span>        <span class="keyword">public</span> <span class="keywordtype">double</span> <a class="code" href="class_phylo_tree_1_1_tree_node.html#a0c8dc9e138bb0ccc6e1bd75a457b2a62">TotalLength</a>()</div>
<div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;        {</div>
<div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;            <span class="keywordtype">double</span> tbr = this.<a class="code" href="class_phylo_tree_1_1_tree_node.html#a86b94683f7e5ba653601ad8068945e69">Length</a>;</div>
<div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160; </div>
<div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; this.Children.Count; i++)</div>
<div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;            {</div>
<div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;                tbr += this.Children[i].TotalLength();</div>
<div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;            }</div>
<div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;            <span class="keywordflow">return</span> tbr;</div>
<div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;        }</div>
<div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;<span class="comment">        /// &lt;summary&gt;</span></div>
<div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;<span class="comment">        /// Sort (in place) the nodes in the tree in an aesthetically pleasing way.</span></div>
<div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;<span class="comment">        /// &lt;/summary&gt;</span></div>
<div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;<span class="comment">        /// &lt;param name=&quot;descending&quot;&gt;The way the nodes should be sorted.&lt;/param&gt;</span></div>
<div class="line"><a name="l00920"></a><span class="lineno"><a class="line" href="class_phylo_tree_1_1_tree_node.html#ac892dc9cb8ad98900a0ab1a40e44b8f7">  920</a></span>&#160;<span class="comment"></span>        <span class="keyword">public</span> <span class="keywordtype">void</span> <a class="code" href="class_phylo_tree_1_1_tree_node.html#ac892dc9cb8ad98900a0ab1a40e44b8f7">SortNodes</a>(<span class="keywordtype">bool</span> descending)</div>
<div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;        {</div>
<div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; this.Children.Count; i++)</div>
<div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;            {</div>
<div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;                this.Children[i].SortNodes(descending);</div>
<div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;            }</div>
<div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160; </div>
<div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;            <span class="keywordflow">if</span> (this.Children.Count &gt; 0)</div>
<div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;            {</div>
<div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;                this.Children.Sort((a, b) =&gt;</div>
<div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;                {</div>
<div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;                    <span class="keywordtype">int</span> val = (a.GetLevels(<span class="keyword">true</span>)[1] - b.GetLevels(<span class="keyword">true</span>)[1]) * (descending ? 1 : -1);</div>
<div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;                    <span class="keywordflow">if</span> (val != 0)</div>
<div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;                    {</div>
<div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;                        <span class="keywordflow">return</span> val;</div>
<div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;                    }</div>
<div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;                    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;                    {</div>
<div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;                        <span class="keywordflow">return</span> <span class="keywordtype">string</span>.Compare(a.GetLeafNames()[0], b.GetLeafNames()[0], StringComparison.InvariantCulture);</div>
<div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;                    }</div>
<div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;                });</div>
<div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;            }</div>
<div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;        }</div>
<div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;<span class="comment">        /// &lt;summary&gt;</span></div>
<div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;<span class="comment">        /// Determine how many levels there are in the tree above and below this node.</span></div>
<div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;<span class="comment">        /// &lt;/summary&gt;</span></div>
<div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;<span class="comment">        /// &lt;param name=&quot;ignoreTotal&quot;&gt;If this is &lt;c&gt;true&lt;/c&gt;, the total number of levels is not computed (this improves performance).&lt;/param&gt;</span></div>
<div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;<span class="comment">        /// &lt;returns&gt;</span></div>
<div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;<span class="comment">        /// An &lt;see cref=&quot;int&quot;/&gt; array with 3 elements: the first element is the number of levels above this node, the second element is the number of levels below this node, and the third element is the total number of levels in the tree.</span></div>
<div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;<span class="comment">        /// If &lt;paramref name=&quot;ignoreTotal&quot;/&gt; is &lt;c&gt;true&lt;/c&gt;, the third element is equal to the second.</span></div>
<div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;<span class="comment">        /// &lt;/returns&gt;</span></div>
<div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;<span class="comment"></span>        <span class="keyword">internal</span> <span class="keywordtype">int</span>[] GetLevels(<span class="keywordtype">bool</span> ignoreTotal = <span class="keyword">false</span>)</div>
<div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;        {</div>
<div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;            <span class="keywordtype">int</span> upperCount = 0;</div>
<div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;            <a class="code" href="class_phylo_tree_1_1_tree_node.html">TreeNode</a> prnt = this.<a class="code" href="class_phylo_tree_1_1_tree_node.html#ad013d0a85374f6055b067d21ec455aa8">Parent</a>;</div>
<div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;            <a class="code" href="class_phylo_tree_1_1_tree_node.html">TreeNode</a> lastPrnt = <span class="keyword">null</span>;</div>
<div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;            <span class="keywordflow">while</span> (prnt != <span class="keyword">null</span>)</div>
<div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;            {</div>
<div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;                lastPrnt = prnt;</div>
<div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;                upperCount++;</div>
<div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;                prnt = prnt.<a class="code" href="class_phylo_tree_1_1_tree_node.html#ad013d0a85374f6055b067d21ec455aa8">Parent</a>;</div>
<div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;            }</div>
<div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160; </div>
<div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;            <span class="keywordtype">int</span> lowerCount = 0;</div>
<div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;            <span class="keywordflow">if</span> (this.Children.Count &gt; 0)</div>
<div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;            {</div>
<div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; this.Children.Count; i++)</div>
<div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;                {</div>
<div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;                    <a class="code" href="class_phylo_tree_1_1_tree_node.html#af46398d315eaa6c973f21655baed8030">TreeNode</a> ch = this.Children[i];</div>
<div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;                    lowerCount = Math.Max(lowerCount, 1 + ch.GetLevels(<span class="keyword">true</span>)[1]);</div>
<div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;                }</div>
<div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;            }</div>
<div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160; </div>
<div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;            <span class="keywordflow">if</span> (this.<a class="code" href="class_phylo_tree_1_1_tree_node.html#ad013d0a85374f6055b067d21ec455aa8">Parent</a> != <span class="keyword">null</span> &amp;&amp; !ignoreTotal)</div>
<div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;            {</div>
<div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;                <span class="keywordflow">return</span> <span class="keyword">new</span> <span class="keywordtype">int</span>[] { upperCount, lowerCount, lastPrnt.GetLevels()[2] };</div>
<div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;            }</div>
<div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;            {</div>
<div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;                <span class="keywordflow">return</span> <span class="keyword">new</span> <span class="keywordtype">int</span>[] { upperCount, lowerCount, lowerCount };</div>
<div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;            }</div>
<div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160; </div>
<div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;        }</div>
<div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;<span class="comment">        /// &lt;summary&gt;</span></div>
<div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;<span class="comment">        /// Convert the tree to a Newick string.</span></div>
<div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;<span class="comment">        /// &lt;/summary&gt;</span></div>
<div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;<span class="comment">        /// &lt;returns&gt;&lt;/returns&gt;</span></div>
<div class="line"><a name="l00989"></a><span class="lineno"><a class="line" href="class_phylo_tree_1_1_tree_node.html#a99bc34026d9c4e33aeac43be72e6b221">  989</a></span>&#160;<span class="comment"></span>        <span class="keyword">public</span> <span class="keyword">override</span> <span class="keywordtype">string</span> <a class="code" href="class_phylo_tree_1_1_tree_node.html#a99bc34026d9c4e33aeac43be72e6b221">ToString</a>()</div>
<div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;        {</div>
<div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="class_phylo_tree_1_1_formats_1_1_n_w_k_a.html">NWKA</a>.<a class="code" href="class_phylo_tree_1_1_formats_1_1_n_w_k_a.html#acb0ab47154a11e53ca440ab6effa6c6d">WriteTree</a>(<span class="keyword">this</span>, <span class="keyword">false</span>, <span class="keyword">true</span>);</div>
<div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;        }</div>
<div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;<span class="comment">        /// &lt;summary&gt;</span></div>
<div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;<span class="comment">        /// Determines whether the tree is clock-like (i.e. all tips are contemporaneous) or not.</span></div>
<div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;<span class="comment">        /// &lt;/summary&gt;</span></div>
<div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;<span class="comment">        /// &lt;param name=&quot;tolerance&quot;&gt;The (relative) tolerance when comparing branch lengths.&lt;/param&gt;</span></div>
<div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;<span class="comment">        /// &lt;returns&gt;A boolean value determining whether the tree is clock-like or not&lt;/returns&gt;</span></div>
<div class="line"><a name="l00999"></a><span class="lineno"><a class="line" href="class_phylo_tree_1_1_tree_node.html#a29820cfcbac38e613dd6b6c21f1ac913">  999</a></span>&#160;<span class="comment"></span>        <span class="keyword">public</span> <span class="keywordtype">bool</span> <a class="code" href="class_phylo_tree_1_1_tree_node.html#a29820cfcbac38e613dd6b6c21f1ac913">IsClockLike</a>(<span class="keywordtype">double</span> tolerance = 0.001)</div>
<div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;        {</div>
<div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;            List&lt;TreeNode&gt; leaves = this.<a class="code" href="class_phylo_tree_1_1_tree_node.html#abd6553ee2108df823c68b7bd066402c1">GetLeaves</a>();</div>
<div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160; </div>
<div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;            <span class="keywordtype">double</span> len = leaves[0].UpstreamLength();</div>
<div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160; </div>
<div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;            <span class="keywordflow">foreach</span> (<a class="code" href="class_phylo_tree_1_1_tree_node.html">TreeNode</a> leaf <span class="keywordflow">in</span> leaves)</div>
<div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;            {</div>
<div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;                <span class="keywordflow">if</span> (Math.Abs(leaf.<a class="code" href="class_phylo_tree_1_1_tree_node.html#a4ce9baade2f082764a748b65a7564d55">UpstreamLength</a>() / len - 1) &gt; tolerance)</div>
<div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;                {</div>
<div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;                    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;                }</div>
<div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;            }</div>
<div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160; </div>
<div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;        }</div>
<div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;<span class="comment">        /// &lt;summary&gt;</span></div>
<div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;<span class="comment">        /// Gets the last common ancestor of all the specified nodes, or &lt;c&gt;null&lt;/c&gt; if the tree doesn&#39;t contain all the nodes.</span></div>
<div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;<span class="comment">        /// &lt;/summary&gt;</span></div>
<div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;<span class="comment">        /// &lt;param name=&quot;monophyleticConstraint&quot;&gt;The collection of nodes whose last common ancestor is to be determined.&lt;/param&gt;</span></div>
<div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;<span class="comment">        /// &lt;returns&gt;The last common ancestor of all the specified nodes, or &lt;c&gt;null&lt;/c&gt; if the tree doesn&#39;t contain all the nodes.&lt;/returns&gt;</span></div>
<div class="line"><a name="l01021"></a><span class="lineno"><a class="line" href="class_phylo_tree_1_1_tree_node.html#aa4a24b971f90ec80dc8dcac2d72756d7"> 1021</a></span>&#160;<span class="comment"></span>        <span class="keyword">public</span> <span class="keyword">static</span> <a class="code" href="class_phylo_tree_1_1_tree_node.html">TreeNode</a> <a class="code" href="class_phylo_tree_1_1_tree_node.html#aa4a24b971f90ec80dc8dcac2d72756d7">GetLastCommonAncestor</a>(IEnumerable&lt;TreeNode&gt; monophyleticConstraint)</div>
<div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;        {</div>
<div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;            <span class="keywordflow">if</span> (monophyleticConstraint.Any())</div>
<div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;            {</div>
<div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;                <a class="code" href="class_phylo_tree_1_1_tree_node.html">TreeNode</a> seed = monophyleticConstraint.ElementAt(0);</div>
<div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160; </div>
<div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;                <span class="keywordflow">while</span> (seed != <span class="keyword">null</span> &amp;&amp; !seed.<a class="code" href="class_phylo_tree_1_1_tree_node.html#a10f3cbaa55715ca0c062ad6aee626e0f">GetChildrenRecursive</a>().ContainsAll(monophyleticConstraint))</div>
<div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;                {</div>
<div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;                    seed = seed.<a class="code" href="class_phylo_tree_1_1_tree_node.html#ad013d0a85374f6055b067d21ec455aa8">Parent</a>;</div>
<div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;                }</div>
<div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160; </div>
<div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;                <span class="keywordflow">return</span> seed;</div>
<div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;            }</div>
<div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;            {</div>
<div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;                <span class="keywordflow">return</span> <span class="keyword">null</span>;</div>
<div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;            }</div>
<div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;        }</div>
<div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;<span class="comment">        /// &lt;summary&gt;</span></div>
<div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;<span class="comment">        /// Gets the last common ancestor of all the nodes with the specified names, or &lt;c&gt;null&lt;/c&gt; if the tree doesn&#39;t contain all the named nodes.</span></div>
<div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;<span class="comment">        /// &lt;/summary&gt;</span></div>
<div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;<span class="comment">        /// &lt;param name=&quot;monophyleticConstraint&quot;&gt;The collection of names representing nodes whose last common ancestor is to be determined.&lt;/param&gt;</span></div>
<div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;<span class="comment">        /// &lt;returns&gt;The last common ancestor of all the nodes with the specified names, or &lt;c&gt;null&lt;/c&gt; if the tree doesn&#39;t contain all the named nodes.&lt;/returns&gt;</span></div>
<div class="line"><a name="l01045"></a><span class="lineno"><a class="line" href="class_phylo_tree_1_1_tree_node.html#a69affd381d9a2fbac70a0ac12cfbb346"> 1045</a></span>&#160;<span class="comment"></span>        <span class="keyword">public</span> <a class="code" href="class_phylo_tree_1_1_tree_node.html">TreeNode</a> <a class="code" href="class_phylo_tree_1_1_tree_node.html#a69affd381d9a2fbac70a0ac12cfbb346">GetLastCommonAncestor</a>(params <span class="keywordtype">string</span>[] monophyleticConstraint)</div>
<div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;        {</div>
<div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;            <span class="keywordflow">return</span> this.<a class="code" href="class_phylo_tree_1_1_tree_node.html#aa4a24b971f90ec80dc8dcac2d72756d7">GetLastCommonAncestor</a>((IEnumerable&lt;string&gt;)monophyleticConstraint);</div>
<div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;        }</div>
<div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;<span class="comment">        /// &lt;summary&gt;</span></div>
<div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;<span class="comment">        /// Gets the last common ancestor of all the nodes with the specified names, or &lt;c&gt;null&lt;/c&gt; if the tree doesn&#39;t contain all the named nodes.</span></div>
<div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;<span class="comment">        /// &lt;/summary&gt;</span></div>
<div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;<span class="comment">        /// &lt;param name=&quot;monophyleticConstraint&quot;&gt;The collection of names representing nodes whose last common ancestor is to be determined.&lt;/param&gt;</span></div>
<div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;<span class="comment">        /// &lt;returns&gt;The last common ancestor of all the nodes with the specified names, or &lt;c&gt;null&lt;/c&gt; if the tree doesn&#39;t contain all the named nodes.&lt;/returns&gt;</span></div>
<div class="line"><a name="l01055"></a><span class="lineno"><a class="line" href="class_phylo_tree_1_1_tree_node.html#af1ddaf03343bfe932654ac5bf8b40269"> 1055</a></span>&#160;<span class="comment"></span>        <span class="keyword">public</span> <a class="code" href="class_phylo_tree_1_1_tree_node.html">TreeNode</a> <a class="code" href="class_phylo_tree_1_1_tree_node.html#af1ddaf03343bfe932654ac5bf8b40269">GetLastCommonAncestor</a>(IEnumerable&lt;string&gt; monophyleticConstraint)</div>
<div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;        {</div>
<div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;            <span class="keywordflow">if</span> (monophyleticConstraint.Any())</div>
<div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;            {</div>
<div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;                <a class="code" href="class_phylo_tree_1_1_tree_node.html">TreeNode</a> seed = this.<a class="code" href="class_phylo_tree_1_1_tree_node.html#af6f61b610664c8de60f2622420318f69">GetNodeFromName</a>(monophyleticConstraint.ElementAt(0));</div>
<div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160; </div>
<div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;                <span class="keywordflow">while</span> (seed != <span class="keyword">null</span> &amp;&amp; !seed.<a class="code" href="class_phylo_tree_1_1_tree_node.html#a0190778929ce3b54ac2be351dd62bb78">GetNodeNames</a>().ContainsAll(monophyleticConstraint))</div>
<div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;                {</div>
<div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;                    seed = seed.<a class="code" href="class_phylo_tree_1_1_tree_node.html#ad013d0a85374f6055b067d21ec455aa8">Parent</a>;</div>
<div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;                }</div>
<div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160; </div>
<div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;                <span class="keywordflow">return</span> seed;</div>
<div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;            }</div>
<div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;            {</div>
<div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;                <span class="keywordflow">return</span> <span class="keyword">null</span>;</div>
<div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;            }</div>
<div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;        }</div>
<div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;<span class="comment">        /// &lt;summary&gt;</span></div>
<div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;<span class="comment">        /// Checks whether this node is the last common ancestor of all the nodes with the specified names.</span></div>
<div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;<span class="comment">        /// &lt;/summary&gt;</span></div>
<div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;<span class="comment">        /// &lt;param name=&quot;monophyleticConstraint&quot;&gt;The collection of names representing nodes whose last common ancestor is to be determined.&lt;/param&gt;</span></div>
<div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;<span class="comment">        /// &lt;returns&gt;&lt;c&gt;true&lt;/c&gt; if this node is the last common ancestor of all the nodes with the specified names, &lt;c&gt;false&lt;/c&gt; otherwise.&lt;/returns&gt;</span></div>
<div class="line"><a name="l01079"></a><span class="lineno"><a class="line" href="class_phylo_tree_1_1_tree_node.html#a1ebae6c6bb410d78e6cc709cc986c142"> 1079</a></span>&#160;<span class="comment"></span>        <span class="keyword">public</span> <span class="keywordtype">bool</span> <a class="code" href="class_phylo_tree_1_1_tree_node.html#a1ebae6c6bb410d78e6cc709cc986c142">IsLastCommonAncestor</a>(IEnumerable&lt;string&gt; monophyleticConstraint)</div>
<div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;        {</div>
<div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;            <span class="keywordflow">if</span> (monophyleticConstraint.Any())</div>
<div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;            {</div>
<div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;                <a class="code" href="class_phylo_tree_1_1_tree_node.html">TreeNode</a> seed = this.<a class="code" href="class_phylo_tree_1_1_tree_node.html#af6f61b610664c8de60f2622420318f69">GetNodeFromName</a>(monophyleticConstraint.ElementAt(0));</div>
<div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160; </div>
<div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;                <span class="keywordflow">while</span> (seed != <span class="keyword">null</span> &amp;&amp; !seed.<a class="code" href="class_phylo_tree_1_1_tree_node.html#a8106a348a92ec008a280673485461ab1">GetLeafNames</a>().ContainsAll(monophyleticConstraint))</div>
<div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;                {</div>
<div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;                    seed = seed.<a class="code" href="class_phylo_tree_1_1_tree_node.html#ad013d0a85374f6055b067d21ec455aa8">Parent</a>;</div>
<div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;                }</div>
<div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160; </div>
<div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;                <span class="keywordflow">return</span> seed == <span class="keyword">this</span>;</div>
<div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;            }</div>
<div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;            {</div>
<div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;                <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;            }</div>
<div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;        }</div>
<div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;<span class="comment">        /// &lt;summary&gt;</span></div>
<div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;<span class="comment">        /// Transform the tree into a collection of (undirected) splits.</span></div>
<div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;<span class="comment">        /// &lt;/summary&gt;</span></div>
<div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;<span class="comment">        /// &lt;param name=&quot;lengthType&quot;&gt;Determines whether the &lt;see cref=&quot;Split.Length&quot;/&gt; should represent ages or branch lenghts.&lt;/param&gt;</span></div>
<div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;<span class="comment">        /// &lt;returns&gt;A list of splits induced by the tree. Each split corresponds to a branch in the tree.&lt;/returns&gt;</span></div>
<div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;<span class="comment"></span>        <span class="keyword">internal</span> List&lt;Split&gt; GetSplits(Split.LengthTypes lengthType)</div>
<div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;        {</div>
<div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;            List&lt;Split&gt; tbr = <span class="keyword">new</span> List&lt;Split&gt;();</div>
<div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160; </div>
<div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;            List&lt;TreeNode&gt; nodes = this.<a class="code" href="class_phylo_tree_1_1_tree_node.html#a10f3cbaa55715ca0c062ad6aee626e0f">GetChildrenRecursive</a>();</div>
<div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160; </div>
<div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;            <span class="keywordflow">if</span> (this.Children.Count == 2)</div>
<div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;            {</div>
<div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; nodes.Count; i++)</div>
<div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;                {</div>
<div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;                    List&lt;string&gt; nodeLeaves = nodes[i].GetLeafNames();</div>
<div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;                    nodeLeaves.Sort();</div>
<div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160; </div>
<div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;                    tbr.Add(<span class="keyword">new</span> Split(nodeLeaves.Aggregate((a, b) =&gt; a + <span class="stringliteral">&quot;,&quot;</span> + b), lengthType == Split.LengthTypes.Length ? nodes[i].Length : nodes[i].LongestDownstreamLength(), lengthType, 1));</div>
<div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;                }</div>
<div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;            }</div>
<div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;            {</div>
<div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;                List&lt;string&gt; allLeaves = this.<a class="code" href="class_phylo_tree_1_1_tree_node.html#a8106a348a92ec008a280673485461ab1">GetLeafNames</a>();</div>
<div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160; </div>
<div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; nodes.Count; i++)</div>
<div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;                {</div>
<div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160;                    List&lt;string&gt; nodeLeaves = nodes[i].GetLeafNames();</div>
<div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160; </div>
<div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160;                    List&lt;string&gt; diffLeaves = (from el in allLeaves where !nodeLeaves.Contains(el) select el).ToList();</div>
<div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160; </div>
<div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160;                    nodeLeaves.Sort();</div>
<div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160;                    diffLeaves.Sort();</div>
<div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160; </div>
<div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160;                    <span class="keywordflow">if</span> (diffLeaves.Count &gt; 0)</div>
<div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160;                    {</div>
<div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160;                        List&lt;string&gt; splitTerminals = <span class="keyword">new</span> List&lt;string&gt;() { nodeLeaves.Aggregate((a, b) =&gt; a + <span class="stringliteral">&quot;,&quot;</span> + b), diffLeaves.Aggregate((a, b) =&gt; a + <span class="stringliteral">&quot;,&quot;</span> + b) };</div>
<div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160;                        splitTerminals.Sort();</div>
<div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160; </div>
<div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160;                        tbr.Add(<span class="keyword">new</span> Split(splitTerminals.Aggregate((a, b) =&gt; a + <span class="stringliteral">&quot;|&quot;</span> + b), lengthType == Split.LengthTypes.Length ? nodes[i].Length : (nodes[i].LongestDownstreamLength() + nodes[i].Length), lengthType, 1));</div>
<div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160;                    }</div>
<div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160;                    <span class="keywordflow">else</span></div>
<div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160;                    {</div>
<div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160;                        tbr.Add(<span class="keyword">new</span> Split(nodeLeaves.Aggregate((a, b) =&gt; a + <span class="stringliteral">&quot;,&quot;</span> + b), lengthType == Split.LengthTypes.Length ? nodes[i].Length : nodes[i].LongestDownstreamLength(), lengthType, 1));</div>
<div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160;                    }</div>
<div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160;                }</div>
<div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160; </div>
<div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160;            }</div>
<div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160;            <span class="keywordflow">return</span> tbr;</div>
<div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160;        }</div>
<div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160;    }</div>
<div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160;}</div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<div class="ttc" id="aclass_phylo_tree_1_1_tree_node_html_a69affd381d9a2fbac70a0ac12cfbb346"><div class="ttname"><a href="class_phylo_tree_1_1_tree_node.html#a69affd381d9a2fbac70a0ac12cfbb346">PhyloTree.TreeNode.GetLastCommonAncestor</a></div><div class="ttdeci">TreeNode GetLastCommonAncestor(params string[] monophyleticConstraint)</div><div class="ttdoc">Gets the last common ancestor of all the nodes with the specified names, or null if the tree doesn't ...</div><div class="ttdef"><b>Definition:</b> <a href="_tree_node_8cs_source.html#l01045">TreeNode.cs:1045</a></div></div>
<div class="ttc" id="anamespace_phylo_tree_html"><div class="ttname"><a href="namespace_phylo_tree.html">PhyloTree</a></div><div class="ttdoc">Contains classes and methods to read, write and manipulate phylogenetic trees.</div><div class="ttdef"><b>Definition:</b> <a href="_attribute_dictionary_8cs_source.html#l00007">AttributeDictionary.cs:8</a></div></div>
<div class="ttc" id="aclass_phylo_tree_1_1_tree_node_html_ae6b9afc19b73b1e44638704f02156976"><div class="ttname"><a href="class_phylo_tree_1_1_tree_node.html#ae6b9afc19b73b1e44638704f02156976">PhyloTree.TreeNode.GetRootedTree</a></div><div class="ttdeci">TreeNode GetRootedTree(TreeNode outgroup, double position=0.5)</div><div class="ttdoc">Get a version of the tree that is rooted at the specified point of the branch leading to the outgroup...</div><div class="ttdef"><b>Definition:</b> <a href="_tree_node_8cs_source.html#l00444">TreeNode.cs:444</a></div></div>
<div class="ttc" id="aclass_phylo_tree_1_1_tree_node_html_ad013d0a85374f6055b067d21ec455aa8"><div class="ttname"><a href="class_phylo_tree_1_1_tree_node.html#ad013d0a85374f6055b067d21ec455aa8">PhyloTree.TreeNode.Parent</a></div><div class="ttdeci">TreeNode Parent</div><div class="ttdoc">The parent node of this node. This will be null for the root node.</div><div class="ttdef"><b>Definition:</b> <a href="_tree_node_8cs_source.html#l00310">TreeNode.cs:310</a></div></div>
<div class="ttc" id="aclass_phylo_tree_1_1_tree_node_html_afd3cbefbf37e7aaa6d3516bca73d8a07"><div class="ttname"><a href="class_phylo_tree_1_1_tree_node.html#afd3cbefbf37e7aaa6d3516bca73d8a07">PhyloTree.TreeNode.NodeRelationship</a></div><div class="ttdeci">NodeRelationship</div><div class="ttdoc">Describes the relationship between two nodes.</div><div class="ttdef"><b>Definition:</b> <a href="_tree_node_8cs_source.html#l00806">TreeNode.cs:807</a></div></div>
<div class="ttc" id="aclass_phylo_tree_1_1_tree_node_html_af6f61b610664c8de60f2622420318f69"><div class="ttname"><a href="class_phylo_tree_1_1_tree_node.html#af6f61b610664c8de60f2622420318f69">PhyloTree.TreeNode.GetNodeFromName</a></div><div class="ttdeci">TreeNode GetNodeFromName(string nodeName)</div><div class="ttdoc">Get the child node with the specified name.</div><div class="ttdef"><b>Definition:</b> <a href="_tree_node_8cs_source.html#l00679">TreeNode.cs:679</a></div></div>
<div class="ttc" id="anamespace_phylo_tree_1_1_formats_html"><div class="ttname"><a href="namespace_phylo_tree_1_1_formats.html">PhyloTree.Formats</a></div><div class="ttdoc">Contains classes and methods to read and write phylogenetic trees in multiple formats</div><div class="ttdef"><b>Definition:</b> <a href="_binary_8cs_source.html#l00011">Binary.cs:12</a></div></div>
<div class="ttc" id="anamespace_phylo_tree_1_1_extensions_html"><div class="ttname"><a href="namespace_phylo_tree_1_1_extensions.html">PhyloTree.Extensions</a></div><div class="ttdoc">Contains useful extension methods.</div><div class="ttdef"><b>Definition:</b> <a href="_extensions_8cs_source.html#l00011">Extensions.cs:12</a></div></div>
<div class="ttc" id="aclass_phylo_tree_1_1_tree_node_html_af46398d315eaa6c973f21655baed8030"><div class="ttname"><a href="class_phylo_tree_1_1_tree_node.html#af46398d315eaa6c973f21655baed8030">PhyloTree.TreeNode.TreeNode</a></div><div class="ttdeci">TreeNode(TreeNode parent)</div><div class="ttdoc">Creates a new TreeNode object.</div><div class="ttdef"><b>Definition:</b> <a href="_tree_node_8cs_source.html#l00377">TreeNode.cs:377</a></div></div>
<div class="ttc" id="aclass_phylo_tree_1_1_attribute_dictionary_html_ab8b78a3ae44036451b3c42d9f42ef320"><div class="ttname"><a href="class_phylo_tree_1_1_attribute_dictionary.html#ab8b78a3ae44036451b3c42d9f42ef320">PhyloTree.AttributeDictionary.Support</a></div><div class="ttdeci">double Support</div><div class="ttdoc">The support value of this node. This is double.NaN for branches whose support is not specified....</div><div class="ttdef"><b>Definition:</b> <a href="_attribute_dictionary_8cs_source.html#l00058">AttributeDictionary.cs:59</a></div></div>
<div class="ttc" id="aclass_phylo_tree_1_1_attribute_dictionary_html_a018e1cb442e42860a608ae4182282146"><div class="ttname"><a href="class_phylo_tree_1_1_attribute_dictionary.html#a018e1cb442e42860a608ae4182282146">PhyloTree.AttributeDictionary.Name</a></div><div class="ttdeci">string Name</div><div class="ttdoc">The name of this node (e.g. the species name for leaf nodes). Default is &quot;&quot;. Getting the value of thi...</div><div class="ttdef"><b>Definition:</b> <a href="_attribute_dictionary_8cs_source.html#l00022">AttributeDictionary.cs:23</a></div></div>
<div class="ttc" id="aclass_phylo_tree_1_1_tree_node_html_a8106a348a92ec008a280673485461ab1"><div class="ttname"><a href="class_phylo_tree_1_1_tree_node.html#a8106a348a92ec008a280673485461ab1">PhyloTree.TreeNode.GetLeafNames</a></div><div class="ttdeci">List&lt; string &gt; GetLeafNames()</div><div class="ttdoc">Get the names of all the leaves that descend (directly or indirectly) from this node.</div><div class="ttdef"><b>Definition:</b> <a href="_tree_node_8cs_source.html#l00638">TreeNode.cs:638</a></div></div>
<div class="ttc" id="aclass_phylo_tree_1_1_formats_1_1_n_w_k_a_html_acb0ab47154a11e53ca440ab6effa6c6d"><div class="ttname"><a href="class_phylo_tree_1_1_formats_1_1_n_w_k_a.html#acb0ab47154a11e53ca440ab6effa6c6d">PhyloTree.Formats.NWKA.WriteTree</a></div><div class="ttdeci">static string WriteTree(TreeNode tree, bool nwka, bool singleQuoted=false)</div><div class="ttdoc">Writes a TreeNode to a string.</div><div class="ttdef"><b>Definition:</b> <a href="_n_w_k_a_8cs_source.html#l00685">NWKA.cs:685</a></div></div>
<div class="ttc" id="aclass_phylo_tree_1_1_attribute_dictionary_html_ac16319eeef4510cf5c8fde78d0f12fcc"><div class="ttname"><a href="class_phylo_tree_1_1_attribute_dictionary.html#ac16319eeef4510cf5c8fde78d0f12fcc">PhyloTree.AttributeDictionary.Length</a></div><div class="ttdeci">double Length</div><div class="ttdoc">The length of the branch leading to this node. This is double.NaN for branches whose length is not sp...</div><div class="ttdef"><b>Definition:</b> <a href="_attribute_dictionary_8cs_source.html#l00040">AttributeDictionary.cs:41</a></div></div>
<div class="ttc" id="aclass_phylo_tree_1_1_tree_node_html_a2aa5546576de0f2f76e0c1ff7477a63d"><div class="ttname"><a href="class_phylo_tree_1_1_tree_node.html#a2aa5546576de0f2f76e0c1ff7477a63d">PhyloTree.TreeNode.PathLengthTo</a></div><div class="ttdeci">double PathLengthTo(TreeNode otherNode, NodeRelationship nodeRelationship=NodeRelationship.Unknown)</div><div class="ttdoc">Get the sum of the branch lengths from this node to the specified node.</div><div class="ttdef"><b>Definition:</b> <a href="_tree_node_8cs_source.html#l00835">TreeNode.cs:835</a></div></div>
<div class="ttc" id="aclass_phylo_tree_1_1_tree_node_html_acd4a745d36fedcf6fc283edf113d0408"><div class="ttname"><a href="class_phylo_tree_1_1_tree_node.html#acd4a745d36fedcf6fc283edf113d0408">PhyloTree.TreeNode.GetChildrenRecursiveLazy</a></div><div class="ttdeci">IEnumerable&lt; TreeNode &gt; GetChildrenRecursiveLazy()</div><div class="ttdoc">Lazily recursively get all the nodes that descend from this node.</div><div class="ttdef"><b>Definition:</b> <a href="_tree_node_8cs_source.html#l00601">TreeNode.cs:601</a></div></div>
<div class="ttc" id="aclass_phylo_tree_1_1_tree_node_html_a4884c49733bb5cf44f6d3f7fd796250e"><div class="ttname"><a href="class_phylo_tree_1_1_tree_node.html#a4884c49733bb5cf44f6d3f7fd796250e">PhyloTree.TreeNode.Name</a></div><div class="ttdeci">string Name</div><div class="ttdoc">The name of this node (e.g. the species name for leaf nodes). Default is &quot;&quot;.</div><div class="ttdef"><b>Definition:</b> <a href="_tree_node_8cs_source.html#l00355">TreeNode.cs:356</a></div></div>
<div class="ttc" id="aclass_phylo_tree_1_1_tree_node_html_a0190778929ce3b54ac2be351dd62bb78"><div class="ttname"><a href="class_phylo_tree_1_1_tree_node.html#a0190778929ce3b54ac2be351dd62bb78">PhyloTree.TreeNode.GetNodeNames</a></div><div class="ttdeci">List&lt; string &gt; GetNodeNames()</div><div class="ttdoc">Get the names of all the named nodes that descend (directly or indirectly) from this node.</div><div class="ttdef"><b>Definition:</b> <a href="_tree_node_8cs_source.html#l00658">TreeNode.cs:658</a></div></div>
<div class="ttc" id="aclass_phylo_tree_1_1_tree_node_html_a10f3cbaa55715ca0c062ad6aee626e0f"><div class="ttname"><a href="class_phylo_tree_1_1_tree_node.html#a10f3cbaa55715ca0c062ad6aee626e0f">PhyloTree.TreeNode.GetChildrenRecursive</a></div><div class="ttdeci">List&lt; TreeNode &gt; GetChildrenRecursive()</div><div class="ttdoc">Recursively get all the nodes that descend from this node.</div><div class="ttdef"><b>Definition:</b> <a href="_tree_node_8cs_source.html#l00583">TreeNode.cs:583</a></div></div>
<div class="ttc" id="aclass_phylo_tree_1_1_tree_node_html_a27ac3f4d53bdbc14e0b45ada083407ec"><div class="ttname"><a href="class_phylo_tree_1_1_tree_node.html#a27ac3f4d53bdbc14e0b45ada083407ec">PhyloTree.TreeNode.Attributes</a></div><div class="ttdeci">AttributeDictionary Attributes</div><div class="ttdoc">The attributes of this node. Attributes Name, Length and Support are always included....</div><div class="ttdef"><b>Definition:</b> <a href="_tree_node_8cs_source.html#l00320">TreeNode.cs:320</a></div></div>
<div class="ttc" id="aclass_phylo_tree_1_1_tree_node_html_a30ca619e43389b3c2c0e30e01722393c"><div class="ttname"><a href="class_phylo_tree_1_1_tree_node.html#a30ca619e43389b3c2c0e30e01722393c">PhyloTree.TreeNode.LongestDownstreamLength</a></div><div class="ttdeci">double LongestDownstreamLength()</div><div class="ttdoc">Get the sum of the branch lengths from this node down to the leaves of the tree. If the tree is not c...</div><div class="ttdef"><b>Definition:</b> <a href="_tree_node_8cs_source.html#l00745">TreeNode.cs:745</a></div></div>
<div class="ttc" id="aclass_phylo_tree_1_1_tree_node_html_aa0016b82b80aded16c7c91a172d0c7a6"><div class="ttname"><a href="class_phylo_tree_1_1_tree_node.html#aa0016b82b80aded16c7c91a172d0c7a6">PhyloTree.TreeNode.Clone</a></div><div class="ttdeci">TreeNode Clone()</div><div class="ttdoc">Recursively clone a TreeNode object.</div><div class="ttdef"><b>Definition:</b> <a href="_tree_node_8cs_source.html#l00553">TreeNode.cs:553</a></div></div>
<div class="ttc" id="aclass_phylo_tree_1_1_tree_node_html_a29820cfcbac38e613dd6b6c21f1ac913"><div class="ttname"><a href="class_phylo_tree_1_1_tree_node.html#a29820cfcbac38e613dd6b6c21f1ac913">PhyloTree.TreeNode.IsClockLike</a></div><div class="ttdeci">bool IsClockLike(double tolerance=0.001)</div><div class="ttdoc">Determines whether the tree is clock-like (i.e. all tips are contemporaneous) or not.</div><div class="ttdef"><b>Definition:</b> <a href="_tree_node_8cs_source.html#l00999">TreeNode.cs:999</a></div></div>
<div class="ttc" id="aclass_phylo_tree_1_1_tree_node_html_a86b94683f7e5ba653601ad8068945e69"><div class="ttname"><a href="class_phylo_tree_1_1_tree_node.html#a86b94683f7e5ba653601ad8068945e69">PhyloTree.TreeNode.Length</a></div><div class="ttdeci">double Length</div><div class="ttdoc">The length of the branch leading to this node. This is double.NaN for branches whose length is not sp...</div><div class="ttdef"><b>Definition:</b> <a href="_tree_node_8cs_source.html#l00325">TreeNode.cs:326</a></div></div>
<div class="ttc" id="aclass_phylo_tree_1_1_formats_1_1_n_w_k_a_html"><div class="ttname"><a href="class_phylo_tree_1_1_formats_1_1_n_w_k_a.html">PhyloTree.Formats.NWKA</a></div><div class="ttdoc">Contains methods to read and write trees in Newick and Newick-with-Attributes (NWKA) format.</div><div class="ttdef"><b>Definition:</b> <a href="_n_w_k_a_8cs_source.html#l00015">NWKA.cs:16</a></div></div>
<div class="ttc" id="aclass_phylo_tree_1_1_tree_node_html_a0ea3341e47207ba0fc9d2262eef7f681"><div class="ttname"><a href="class_phylo_tree_1_1_tree_node.html#a0ea3341e47207ba0fc9d2262eef7f681">PhyloTree.TreeNode.Children</a></div><div class="ttdeci">List&lt; TreeNode &gt; Children</div><div class="ttdoc">The child nodes of this node. This will be empty (but initialised) for leaf nodes.</div><div class="ttdef"><b>Definition:</b> <a href="_tree_node_8cs_source.html#l00315">TreeNode.cs:315</a></div></div>
<div class="ttc" id="aclass_phylo_tree_1_1_tree_node_html_a4ce9baade2f082764a748b65a7564d55"><div class="ttname"><a href="class_phylo_tree_1_1_tree_node.html#a4ce9baade2f082764a748b65a7564d55">PhyloTree.TreeNode.UpstreamLength</a></div><div class="ttdeci">double UpstreamLength()</div><div class="ttdoc">Get the sum of the branch lengths from this node up to the root.</div><div class="ttdef"><b>Definition:</b> <a href="_tree_node_8cs_source.html#l00726">TreeNode.cs:726</a></div></div>
<div class="ttc" id="aclass_phylo_tree_1_1_tree_node_html_a0c8dc9e138bb0ccc6e1bd75a457b2a62"><div class="ttname"><a href="class_phylo_tree_1_1_tree_node.html#a0c8dc9e138bb0ccc6e1bd75a457b2a62">PhyloTree.TreeNode.TotalLength</a></div><div class="ttdeci">double TotalLength()</div><div class="ttdoc">Get the sum of the branch lengths of this node and all its descendants.</div><div class="ttdef"><b>Definition:</b> <a href="_tree_node_8cs_source.html#l00905">TreeNode.cs:905</a></div></div>
<div class="ttc" id="aclass_phylo_tree_1_1_tree_node_html"><div class="ttname"><a href="class_phylo_tree_1_1_tree_node.html">PhyloTree.TreeNode</a></div><div class="ttdoc">Represents a node in a tree (or a whole tree).</div><div class="ttdef"><b>Definition:</b> <a href="_tree_node_8cs_source.html#l00305">TreeNode.cs:306</a></div></div>
<div class="ttc" id="aclass_phylo_tree_1_1_tree_node_html_aa4a24b971f90ec80dc8dcac2d72756d7"><div class="ttname"><a href="class_phylo_tree_1_1_tree_node.html#aa4a24b971f90ec80dc8dcac2d72756d7">PhyloTree.TreeNode.GetLastCommonAncestor</a></div><div class="ttdeci">static TreeNode GetLastCommonAncestor(IEnumerable&lt; TreeNode &gt; monophyleticConstraint)</div><div class="ttdoc">Gets the last common ancestor of all the specified nodes, or null if the tree doesn't contain all the...</div><div class="ttdef"><b>Definition:</b> <a href="_tree_node_8cs_source.html#l01021">TreeNode.cs:1021</a></div></div>
<div class="ttc" id="aclass_phylo_tree_1_1_tree_node_html_a17dbe72e48873a91dea484509fd636f6"><div class="ttname"><a href="class_phylo_tree_1_1_tree_node.html#a17dbe72e48873a91dea484509fd636f6">PhyloTree.TreeNode.GetUnrootedTree</a></div><div class="ttdeci">TreeNode GetUnrootedTree()</div><div class="ttdoc">Get an unrooted version of the tree.</div><div class="ttdef"><b>Definition:</b> <a href="_tree_node_8cs_source.html#l00397">TreeNode.cs:397</a></div></div>
<div class="ttc" id="aclass_phylo_tree_1_1_tree_node_html_af1ddaf03343bfe932654ac5bf8b40269"><div class="ttname"><a href="class_phylo_tree_1_1_tree_node.html#af1ddaf03343bfe932654ac5bf8b40269">PhyloTree.TreeNode.GetLastCommonAncestor</a></div><div class="ttdeci">TreeNode GetLastCommonAncestor(IEnumerable&lt; string &gt; monophyleticConstraint)</div><div class="ttdoc">Gets the last common ancestor of all the nodes with the specified names, or null if the tree doesn't ...</div><div class="ttdef"><b>Definition:</b> <a href="_tree_node_8cs_source.html#l01055">TreeNode.cs:1055</a></div></div>
<div class="ttc" id="aclass_phylo_tree_1_1_tree_node_html_a0112912c88ce3b62c11a5352de9ebaab"><div class="ttname"><a href="class_phylo_tree_1_1_tree_node.html#a0112912c88ce3b62c11a5352de9ebaab">PhyloTree.TreeNode.ShortestDownstreamLength</a></div><div class="ttdeci">double ShortestDownstreamLength()</div><div class="ttdoc">Get the sum of the branch lengths from this node down to the leaves of the tree. If the tree is not c...</div><div class="ttdef"><b>Definition:</b> <a href="_tree_node_8cs_source.html#l00769">TreeNode.cs:769</a></div></div>
<div class="ttc" id="aclass_phylo_tree_1_1_tree_node_html_af08b6ddc4fdf955f91e53a6ca7554538"><div class="ttname"><a href="class_phylo_tree_1_1_tree_node.html#af08b6ddc4fdf955f91e53a6ca7554538">PhyloTree.TreeNode.GetRootNode</a></div><div class="ttdeci">TreeNode GetRootNode()</div><div class="ttdoc">Get the node of the tree from which all other nodes descend.</div><div class="ttdef"><b>Definition:</b> <a href="_tree_node_8cs_source.html#l00793">TreeNode.cs:793</a></div></div>
<div class="ttc" id="aclass_phylo_tree_1_1_tree_node_html_ac892dc9cb8ad98900a0ab1a40e44b8f7"><div class="ttname"><a href="class_phylo_tree_1_1_tree_node.html#ac892dc9cb8ad98900a0ab1a40e44b8f7">PhyloTree.TreeNode.SortNodes</a></div><div class="ttdeci">void SortNodes(bool descending)</div><div class="ttdoc">Sort (in place) the nodes in the tree in an aesthetically pleasing way.</div><div class="ttdef"><b>Definition:</b> <a href="_tree_node_8cs_source.html#l00920">TreeNode.cs:920</a></div></div>
<div class="ttc" id="aclass_phylo_tree_1_1_attribute_dictionary_html"><div class="ttname"><a href="class_phylo_tree_1_1_attribute_dictionary.html">PhyloTree.AttributeDictionary</a></div><div class="ttdoc">Represents the attributes of a node. Attributes Name, Length and Support are always included....</div><div class="ttdef"><b>Definition:</b> <a href="_attribute_dictionary_8cs_source.html#l00013">AttributeDictionary.cs:14</a></div></div>
<div class="ttc" id="aclass_phylo_tree_1_1_tree_node_html_a3ab120b9c1bc00902321bb42fcd81225"><div class="ttname"><a href="class_phylo_tree_1_1_tree_node.html#a3ab120b9c1bc00902321bb42fcd81225">PhyloTree.TreeNode.Support</a></div><div class="ttdeci">double Support</div><div class="ttdoc">The support value of this node. This is double.NaN for branches whose support is not specified....</div><div class="ttdef"><b>Definition:</b> <a href="_tree_node_8cs_source.html#l00340">TreeNode.cs:341</a></div></div>
<div class="ttc" id="aclass_phylo_tree_1_1_tree_node_html_a1ebae6c6bb410d78e6cc709cc986c142"><div class="ttname"><a href="class_phylo_tree_1_1_tree_node.html#a1ebae6c6bb410d78e6cc709cc986c142">PhyloTree.TreeNode.IsLastCommonAncestor</a></div><div class="ttdeci">bool IsLastCommonAncestor(IEnumerable&lt; string &gt; monophyleticConstraint)</div><div class="ttdoc">Checks whether this node is the last common ancestor of all the nodes with the specified names.</div><div class="ttdef"><b>Definition:</b> <a href="_tree_node_8cs_source.html#l01079">TreeNode.cs:1079</a></div></div>
<div class="ttc" id="aclass_phylo_tree_1_1_tree_node_html_a99bc34026d9c4e33aeac43be72e6b221"><div class="ttname"><a href="class_phylo_tree_1_1_tree_node.html#a99bc34026d9c4e33aeac43be72e6b221">PhyloTree.TreeNode.ToString</a></div><div class="ttdeci">override string ToString()</div><div class="ttdoc">Convert the tree to a Newick string.</div><div class="ttdef"><b>Definition:</b> <a href="_tree_node_8cs_source.html#l00989">TreeNode.cs:989</a></div></div>
<div class="ttc" id="aclass_phylo_tree_1_1_tree_node_html_a4ef1e16b6ce765e8c54ff1ec32fb68a0"><div class="ttname"><a href="class_phylo_tree_1_1_tree_node.html#a4ef1e16b6ce765e8c54ff1ec32fb68a0">PhyloTree.TreeNode.Id</a></div><div class="ttdeci">string Id</div><div class="ttdoc">A univocal identifier for the node.</div><div class="ttdef"><b>Definition:</b> <a href="_tree_node_8cs_source.html#l00371">TreeNode.cs:371</a></div></div>
<div class="ttc" id="aclass_phylo_tree_1_1_tree_node_html_abd6553ee2108df823c68b7bd066402c1"><div class="ttname"><a href="class_phylo_tree_1_1_tree_node.html#abd6553ee2108df823c68b7bd066402c1">PhyloTree.TreeNode.GetLeaves</a></div><div class="ttdeci">List&lt; TreeNode &gt; GetLeaves()</div><div class="ttdoc">Get all the leaves that descend (directly or indirectly) from this node.</div><div class="ttdef"><b>Definition:</b> <a href="_tree_node_8cs_source.html#l00618">TreeNode.cs:618</a></div></div>
<div class="ttc" id="aclass_phylo_tree_1_1_tree_node_html_a5b10a1f2732bece732618a1ce000b0f1"><div class="ttname"><a href="class_phylo_tree_1_1_tree_node.html#a5b10a1f2732bece732618a1ce000b0f1">PhyloTree.TreeNode.GetNodeFromId</a></div><div class="ttdeci">TreeNode GetNodeFromId(string nodeId)</div><div class="ttdoc">Get the child node with the specified Id.</div><div class="ttdef"><b>Definition:</b> <a href="_tree_node_8cs_source.html#l00703">TreeNode.cs:703</a></div></div>
<div class="ttc" id="aclass_phylo_tree_1_1_tree_node_html_af0e513c07c0f93a13eff4f88573b2af5"><div class="ttname"><a href="class_phylo_tree_1_1_tree_node.html#af0e513c07c0f93a13eff4f88573b2af5">PhyloTree.TreeNode.IsRooted</a></div><div class="ttdeci">bool IsRooted()</div><div class="ttdoc">Checks whether the node belongs to a rooted tree.</div><div class="ttdef"><b>Definition:</b> <a href="_tree_node_8cs_source.html#l00388">TreeNode.cs:388</a></div></div>
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><b>TreeNode.cs</b></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.18 </li>
  </ul>
</div>
</body>
</html>
